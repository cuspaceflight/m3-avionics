/*
 * LDPC code constants/functions
 * Copyright 2016 Adam Greig
 *
 * Codes from CCSDS documents 231.1-O-1 and 131.0-B-2.
 * https://public.ccsds.org/default.aspx
 */

#include <string.h>
#include "ldpc_codes.h"

static void get_code_params(enum ldpc_code code, int* n, int* k, int* m);
static void init_parity_tc(enum ldpc_code code, uint32_t* h);
static void init_parity_tm(enum ldpc_code code, uint32_t* h);
static void init_parity_tm_h12(enum ldpc_code code, uint32_t* h);
static void init_parity_tm_h23(enum ldpc_code code, uint32_t* h);
static void init_parity_tm_h45(enum ldpc_code code, uint32_t* h);

/*
 * Generator matrix constants for the three CCSDS 231.1-O-1 codes,
 * in compact circulant form. Rows 1, M+1, 2M+1, 3M+1 are given, with
 * intermediate rows found by right circular shifts of these rows.
 */
static const uint32_t g_n128_k64[4*2] = {
    0x0E69166B, 0xEF4C0BC2, 0x7766137E, 0xBB248418,
    0xC480FEB9, 0xCD53A713, 0x4EAA22FA, 0x465EEA11,
};

static const uint32_t g_n256_k128[4*4] = {
    0x73F5E839, 0x0220CE51, 0x36ED68E9, 0xF39EB162,
    0xBAC812C0, 0xBCD24379, 0x4786D928, 0x5A09095C,
    0x7DF83F76, 0xA5FF4C38, 0x8E6C0D4E, 0x025EB712,
    0xBAA37B32, 0x60CB31C5, 0xD0F66A31, 0xFAF511BC,
};

static const uint32_t g_n512_k256[4*8] = {
    0x1D21794A, 0x22761FAE, 0x59945014, 0x257E130D,
    0x74D60540, 0x03794014, 0x2DADEB9C, 0xA25EF12E,
    0x60E0B662, 0x3C5CE512, 0x4D2C81EC, 0xC7F469AB,
    0x20678DBF, 0xB7523ECE, 0x2B54B906, 0xA9DBE98C,
    0xF6739BCF, 0x54273E77, 0x167BDA12, 0x0C6C4774,
    0x4C071EFF, 0x5E32A759, 0x3138670C, 0x095C39B5,
    0x28706BD0, 0x45300258, 0x2DAB85F0, 0x5B9201D0,
    0x8DFDEE2D, 0x9D84CA88, 0xB371FAE6, 0x3A4EB07E,
};


/*
 * Parity check matrices corresponding to the above codes.
 * This representation mirrors the definition in CCSDS 231.1-O-1,
 * and can be expanded at runtime to create the actual matrix in memory.
 * Each macro represents a single MxM sub-matrix, where M=n/8.
 */
#define HZ          (0 << 6)                /* All-zero sub-matrix           */
#define HI          (1 << 6)                /* Identity matrix sub-matrix    */
#define HP          (2 << 6)                /* nth right circular shift of I */
#define HS          (HI | HP)               /* HI + HP(n)                    */

static const uint8_t h_n128_k64[4][8] = {
    {HS| 7, HP| 2, HP|14, HP| 6, HZ   , HP| 0, HP|13, HI   },
    {HP| 6, HS|15, HP| 0, HP| 1, HI   , HZ   , HP| 0, HP| 7},
    {HP| 4, HP| 1, HS|15, HP|14, HP|11, HI   , HZ   , HP| 3},
    {HP| 0, HP| 1, HP| 9, HS|13, HP|14, HP| 1, HI   , HZ   },
};

static const uint8_t h_n256_k128[4][8] = {
    {HS|31, HP|15, HP|25, HP| 0, HZ   , HP|20, HP|12, HI   },
    {HP|28, HS|30, HP|29, HP|24, HI   , HZ   , HP| 1, HP|20},
    {HP| 8, HP| 0, HS|28, HI| 1, HP|29, HI   , HZ   , HP|21},
    {HP|18, HP|30, HP| 0, HS|30, HP|25, HP|26, HI   , HZ   },
};

static const uint8_t h_n512_k256[4][8] = {
    {HS|63, HP|30, HP|50, HP|25, HZ   , HP|43, HP|62, HI   },
    {HP|56, HS|61, HP|50, HP|23, HI   , HZ   , HP|37, HP|26},
    {HP|16, HP| 0, HS|55, HP|27, HP|56, HI   , HZ   , HP|43},
    {HP|35, HP|56, HP|62, HS|11, HP|58, HP| 3, HI   , HZ   },
};


/*
 * Generator matrix constants for the CCSDS 131.0-B-2 LDPC codes,
 * in compact circulant form. Each row corresponds to one row in
 * the parity block, and intermediate rows are found by right circular
 * shifts of the specified rows.
 * See scripts/ccsds131_parity_to_generator.py for generation.
 * In principle you could make the k=16384 too but my desktop doesn't have
 * enough RAM to invert the relevant matrices...
 */
static const uint32_t g_n2048_k1024[8*32] = {
    0xCFA794F4, 0x9FA5A0D8, 0x8BB31D8F, 0xCA7EA8BB, 0xA7AE7EE8, 0xA68580E3,
    0xE922F9E1, 0x3359B284, 0x91F72AE8, 0xF2D6BF78, 0x30A1F83B, 0x3CDBD463,
    0xCE95C0EC, 0x1F609370, 0xD7E791C8, 0x70229C1E, 0x71EF3FDF, 0x60E28784,
    0x78934DB2, 0x85DEC9DC, 0x0E95C103, 0x008B6BCD, 0xD2DAF85C, 0xAE732210,
    0x8326EE83, 0xC1FBA56F, 0xDD15B2DD, 0xB31FE7F2, 0x3BA0BB43, 0xF83C67BD,
    0xA1F6AEE4, 0x6AEF4E62, 0x56508378, 0x0CA89ACA, 0xA70CCFB4, 0xA888AE35,
    0x1210FAD0, 0xEC9602CC, 0x8C96B0A8, 0x6D3996A3, 0xC0B07FDD, 0xA73454C2,
    0x5295F72B, 0xD5004E80, 0xACCF973F, 0xC30261C9, 0x90525AA0, 0xCBA006BD,
    0x9F079F09, 0xA405F7F8, 0x7AD98429, 0x096F2A7E, 0xEB8C9B13, 0xB84C06E4,
    0x2843A476, 0x89A9C528, 0xDAAA1A17, 0x5F598DCF, 0xDBAD426C, 0xA43AD479,
    0x1BA78326, 0xE75F38EB, 0x6ED09A45, 0x303A6425, 0x48F42033, 0xB7B9A051,
    0x49DC839C, 0x90291E98, 0x9B2CEBE5, 0x0A7C2C26, 0x4FC6E7D6, 0x74063589,
    0xF5B6DEAE, 0xBF72106B, 0xA9E66765, 0x64C17134, 0x6D595455, 0x8D235191,
    0x50AAF88D, 0x7008E634, 0x1FA962FB, 0xAB864A5F, 0x867C9D6C, 0xF4E087AA,
    0x5D7AA674, 0xBA4B1D8C, 0xD7AE9186, 0xF1D3B23B, 0x047F1127, 0x91EE97B6,
    0x3FB7B58F, 0xF3B94E95, 0x93BE39A6, 0x365C66B8, 0x77AD3169, 0x65A72F5B,
    0x1B58F88E, 0x49C00DC6, 0xB35855BF, 0xF228A088, 0x5C8ED47B, 0x61EEC66B,
    0x5004FB6E, 0x65CBECF3, 0x77789998, 0xFE80925E, 0x0237F570, 0xE04C5F5B,
    0xED677661, 0xEB7FC382, 0x5AB5D5D9, 0x68C0808C, 0x2BDB828B, 0x19593F41,
    0x671B8D0D, 0x41DF136C, 0xCB47553C, 0x9B3F0EA0, 0x16CC1554, 0xC35E6A7D,
    0x97587FEA, 0x91D2098E, 0x126EA73C, 0xC78658A6, 0xADE19711, 0x208186CA,
    0x95C7417A, 0x15690C45, 0xBE9C169D, 0x889339D9, 0x654C976A, 0x85CFD9F7,
    0x47C4148E, 0x3B4712DA, 0xA3BAD1AD, 0x71873D3A, 0x1CD630C3, 0x42C5EBB9,
    0x183ADE9B, 0xEF294E8E, 0x7014C077, 0xA5F96F75, 0xBE566C86, 0x6964D01C,
    0xE72AC43A, 0x35AD2166, 0x72EBB325, 0x9B77F9BB, 0x18DA8B09, 0x194FA1F0,
    0xE876A080, 0xC9D6A39F, 0x809B168A, 0x3D88E8E9, 0x3D995CE5, 0x232C2DC2,
    0xC7CFA44A, 0x363F628A, 0x668D46C3, 0x98CAF96F, 0xD57DBB24, 0xAE27ACA1,
    0x716F8EA1, 0xB8AA1086, 0x7B7796F4, 0xA86F1FD5, 0x4C7576AD, 0x01C68953,
    0xE75BE799, 0x02448236, 0x8F069658, 0xF7AAAFB0, 0x975F3AF7, 0x95E78D25,
    0x5871C71B, 0x4F4B77F6, 0x65CD9C35, 0x9BB2A82D, 0x5353E007, 0x166BDD41,
    0x2C544731, 0x4DB027B1, 0x0B130071, 0xAD0398D1, 0xDE19BC7A, 0x6BBCF6A0,
    0xFF021AAB, 0xF12920A5, 0x58BAED48, 0x4AF89E29, 0xD4DBC170, 0xCEF1D369,
    0x4C330B2D, 0x11E15B5C, 0xB3815E09, 0x605338A6, 0x75E3D1A3, 0x541E0E28,
    0x4F6556D6, 0x8D3C8A9E, 0xE5BB3B29, 0x7DB62CD2, 0x907F0999, 0x6967A0F4,
    0xFF33AEEE, 0x2C8A4A52, 0xFCCF5C39, 0xD355C39C, 0x5FE5F09A, 0xBA6BCCE0,
    0x2A73401E, 0x5F87EAC2, 0xD75702F4, 0xF57670DF, 0xA70B1C00, 0x2F523EEA,
    0x6CE1CE2E, 0x05D420CB, 0x867EC016, 0x6B8E53A9, 0x9DF9801A, 0x1C33058D,
    0xD116A0AE, 0x7278BBB9, 0x4CF0B0C7, 0x92DD8FDB, 0x3ECEAE6F, 0x2B7F663D,
    0x106A1C29, 0x6E47C14C, 0x1498B045, 0xD57DEFB5, 0x968F6D8C, 0x790263C3,
    0x53CF307E, 0xF90C1F21, 0x66E6B632, 0xF6614E58, 0x267EF096, 0xC37718A3,
    0x3D46E5D1, 0x0E993EB6, 0xDF81518F, 0x885EDA1B, 0x6FF518FD, 0x48BB8E9D,
    0xDBED4AC0, 0xF4F5EB89, 0xBCC64D21, 0xA65DB379, 0xABE2E4DC, 0x21F109FF,
    0x2EC0CE7B, 0x5D40973D, 0x13ECF713, 0xB01C6F10
};

static const uint32_t g_n1536_k1024[16*16] = {
    0x51236781, 0x781D416A, 0xB0C8419F, 0xA21559A8, 0x5F14E1E4, 0xD88726F1,
    0x762F6ED6, 0xCF32F06D, 0x8ABFD971, 0xE17A0BE9, 0xA5D14774, 0x1B698D14,
    0x2A58AB30, 0xE2BC32D3, 0x9F251FBC, 0x5DB8C768, 0xD73C205B, 0xBEB231CB,
    0xCAB5EFF5, 0xB2C76C71, 0xFA70FAD4, 0x8828355F, 0x68C6138F, 0xA5524A61,
    0xBB20031D, 0x7AA8FE69, 0x432ADE44, 0x6F49CE27, 0x5E5DB9CC, 0xCEBD1326,
    0xE8782B1B, 0x01F2ABA2, 0x4748E951, 0x3B41147A, 0x17B1FBB7, 0x8B4F914C,
    0x281F5680, 0xBA56DE50, 0x74B0FB08, 0x17E33E2B, 0xDD166CFB, 0x774B5959,
    0xAC7FDCEA, 0x4FECB5BE, 0xED747C81, 0xB540D66A, 0xB2A6A203, 0x9A87967F,
    0x4780DCB2, 0xDC5CBFAE, 0x55BC8FF8, 0x4EC89440, 0xE5D41122, 0x3F09979F,
    0xDDDE9D94, 0x0A15A801, 0x19406463, 0x9D254969, 0x1BE32DDC, 0x829B0032,
    0x1326515A, 0x22EE88A2, 0x0EC664DD, 0x2D701891, 0x69748DFE, 0x6372F2EF,
    0x15F3B0D4, 0x00ACD68A, 0xCF4144CE, 0x1FE2581C, 0x79B1A55B, 0xA59E54AE,
    0x65A2B47E, 0xEBAB0CF3, 0x24DD8757, 0x2CB0F71D, 0xF24ABF15, 0x590F4DA6,
    0x9C3BAE51, 0x969C6502, 0xD3A714B6, 0x0B22789B, 0x3DF5504D, 0x80F54C5A,
    0x9D75CF14, 0x65031211, 0x09834A0C, 0x9F659C99, 0xB9241BDF, 0x76EB3788,
    0x6F927251, 0xC86DECF1, 0x390BE9F5, 0xBBB93D05, 0xC6F435BF, 0xA1FF96B6,
    0x222461B6, 0x58DC3E91, 0xB01DF2A2, 0xEAD2DAA6, 0x5572EE62, 0x78F6F63A,
    0x17B63CB2, 0xFDA3B97F, 0xB233BB25, 0x9F3D83F7, 0xF64760C7, 0x74989384,
    0x46F57E03, 0xF55B1C0B, 0x5AC8A6CE, 0xA05466C1, 0xAE882552, 0x1F85CA31,
    0x37BEED74, 0xB5303407, 0x751FC9A1, 0x5FCEE486, 0x93F0F69B, 0xD04E72A4,
    0xC0EBFA3F, 0x49DF4DBB, 0x03E52D81, 0x5DC99A1D, 0x98FE8BF0, 0x1BB2CD6D,
    0x009C5290, 0xD81A18F6, 0x4FFBAD88, 0x545CAA95, 0x0C74659F, 0xA4828CA3,
    0x60CE56E3, 0x2DA28B2E, 0x299D4BF8, 0x2FE54B81, 0x51047BE3, 0xB3AE4F4B,
    0xF3AC9578, 0xB9477A4C, 0x3730F81F, 0x92767E11, 0x04E84EC3, 0xA3AD1F19,
    0x2D0E0CAB, 0x8EDD2185, 0xCEFBE8F2, 0xF538522A, 0x92DAEDC2, 0x2C441893,
    0xBCB99915, 0x7B35619D, 0x069951BF, 0xB90A08E1, 0x54C7E270, 0xCBA1656E,
    0x7FBBB806, 0xB6A06FB3, 0x7224943B, 0x1C3A5723, 0x1BAA1475, 0x2EFCEBC0,
    0xCFF08949, 0x75557623, 0xFA95908D, 0xC3F34D48, 0xFECA6509, 0x99A26E91,
    0x245433EB, 0xBE9CDA13, 0x5771EAFF, 0x9B02D8FC, 0xBCEBCA57, 0x3D3775C8,
    0x1E46F2B9, 0x51D0EAAB, 0x32942F7F, 0x4743DDF4, 0x8FA2F60A, 0xD62095EF,
    0x80E4A736, 0xB5E1A3A3, 0x01190628, 0x72DAEDF4, 0xE7800695, 0x8CD99F95,
    0xD2062505, 0x7C99C7A3, 0xB569736D, 0xE2167610, 0x0E1C6183, 0xADF09FD0,
    0xE5C492DB, 0xB48B319A, 0xE2D83ADE, 0xFEBBDEFE, 0xAA944EEA, 0x53C77DB3,
    0x0FAA85D9, 0xC13B1F73, 0x8ACED57F, 0x3BE4E807, 0x33CB7262, 0x7624F426,
    0xA0C6E669, 0xB5C74980, 0xABBAEFEA, 0x2D3B69AA, 0xF8366DDA, 0xE56A6DDC,
    0xFDED5582, 0xF4EA6525, 0x4C962827, 0x8ED17036, 0x6E711B6D, 0x20A67966,
    0x3B28BDF0, 0x04C21B93, 0x1BC37B73, 0x0FFC1786, 0x5D20C81D, 0x345FE4B9,
    0x1D14A566, 0x3D369A93, 0x5EBD4BD3, 0x9B2217D0, 0x56833BE1, 0xCDDBA6BC,
    0xB288169B, 0x4E3BB726, 0xC2ED28FB, 0xFC395D1F, 0x035B30C6, 0x8F9A6B6F,
    0x539836A6, 0xE56A7B16, 0xCEB1525C, 0x6ADB65A5, 0x5F71754A, 0xA458B11A,
    0x0DB9D180, 0xB21C0B13, 0x417D86C5, 0x9DF33E49, 0x183A8F6C, 0x44DAFA24,
    0x4E224C18, 0x0C1F0B45, 0xC93CD9CA, 0x23658555, 0x7DDEC5E9, 0x451AD519,
    0xB122C72A, 0x6177EE99, 0x1290B4C6, 0xB007D973
};

static const uint32_t g_n1280_k1024[32*8] = {
    0x678ECB51, 0xFE821D5C, 0xFA5F424B, 0xF55927AA, 0x3E826913, 0x32E04B0C,
    0x4F88862B, 0x803432EF, 0x42B27625, 0x9F8DA1E1, 0xF8472D1B, 0xD943D394,
    0x29261575, 0xBA434C68, 0x18EF349A, 0x27CA1CC4, 0xEC900397, 0x64A4A063,
    0x9BCEC4A6, 0xD05BA70F, 0xE7155BE1, 0x7FF09CC1, 0x6E2E2059, 0x7F1567E5,
    0x5616101C, 0xEA060E2B, 0xB673068B, 0x923BDF8B, 0xB9B9343D, 0x049C63A8,
    0x333E9CFE, 0x809B362D, 0x9D41634C, 0x404E17DA, 0x3B4161F2, 0x5235992E,
    0xEA4B4B8B, 0x4690BCE1, 0xF9DA36A1, 0x16439BB1, 0x5D7254B5, 0x15B4978B,
    0x00D05224, 0x107BD904, 0xC85D7E58, 0x0451F1A5, 0xEE9D1897, 0x913DA6F9,
    0x42819F61, 0x343773CA, 0x11A6492A, 0x4832F43F, 0x849C11ED, 0xF0FE864F,
    0xCC270400, 0x9726D66E, 0x89EE2A44, 0x685C1F67, 0x1DF6E416, 0x507BF2EF,
    0x8759C2FB, 0x52162ABF, 0x2B61D3FB, 0x988708C4, 0x4A8FEA09, 0x53452354,
    0xA33E2E73, 0x271E8211, 0x16DF62E5, 0x03DF81F4, 0x8848BD0F, 0xF95DF357,
    0x9BE0A7B3, 0x617256EB, 0x9A4D0BB4, 0xFE3A3A19, 0xFAA63D9E, 0x65328918,
    0xD699BA35, 0x4CDE6FE0, 0x848B1FE5, 0x0AB58A6F, 0x341707F1, 0xEF36474B,
    0xF623A7A5, 0xA35EC9BA, 0x24909B6E, 0x64A7A898, 0xBDDF3BAE, 0x7202FA26,
    0x86F90C57, 0xA0399F20, 0x972B9A31, 0x87B245AE, 0xE0C5A338, 0x4959AAD9,
    0xCF726C27, 0x7B38429A, 0xBA37C244, 0xEE7717DB, 0xE45C99CA, 0x7E3E013B,
    0x7B800CA4, 0x6527F2E7, 0x75C63782, 0x1CC40137, 0x51E69F16, 0x414B155F,
    0xDF1964DE, 0xF13C71F7, 0x6E9E8044, 0x6C5CEC86, 0x6F2A6DF8, 0x9FF2BF82,
    0xD3625355, 0x24466981, 0xD5F14AC1, 0xE1C24AEA, 0xA8850D83, 0x7A3C5120,
    0xBAABADC3, 0x1ECF066D, 0x76538348, 0xFC5D4D54, 0x43AD46CF, 0x3342012C,
    0x63EBE2DC, 0xD832EF8E, 0xE6EC82F1, 0x4AAFE782, 0x14D89E38, 0x23C83402,
    0x8B48D6BF, 0xC823B89A, 0x68A35626, 0xE89FE121, 0x4BBAA331, 0x20EC16C9,
    0x6ADABE06, 0xD803DA6D, 0xFCC89D41, 0xE57B10E8, 0xCC3FF014, 0x4DB74206,
    0x503FD586, 0x52F68B91, 0x97D69DF3, 0x129C764E, 0x8B2143F7, 0xA36EF3BA,
    0x7C27896C, 0x560F67B5, 0xD70390E6, 0x98B337EA, 0x89568363, 0x2A1681DF,
    0x4B4E928C, 0x41EC3D9C, 0xDFD92EB2, 0xA5D5C85C, 0x2A5088BD, 0x76CB6810,
    0xCB693D21, 0xC0E9EFD5, 0xF992506E, 0x299CE082, 0x901155A6, 0x0B93AA16,
    0x18FEFECE, 0xB0063536, 0x95487089, 0x4BB31BB9, 0x66F3FD97, 0xE32B58A0,
    0x2A39427A, 0x5CD8DE9F, 0x1A8F8616, 0xC5F7D2B2, 0x5AD2BC4E, 0xBF1E86DB,
    0xACF7BFFA, 0xF3589597, 0xA777654C, 0x12DD1364, 0xFFC03A59, 0xDC450527,
    0x33B4C871, 0xBAA2EA33, 0x93A751A6, 0xF9D72E4D, 0x69B50C7F, 0xF74151F9,
    0x7BE8519D, 0xAF6FFAFA, 0x268DBA73, 0xA356128C, 0x0418BE2C, 0x1A43465A,
    0x60C6DF65, 0x0E2438A0, 0xEC25DC05, 0x66AEE4A8, 0xA72A030A, 0xB11FB610,
    0xDD74DAF7, 0x62F6D565, 0x554EAEB7, 0x15F7AE6C, 0x5147F90A, 0xFF0EEC01,
    0x12A9966C, 0x871705B1, 0xE935FF30, 0x46E32957, 0x546D69FC, 0xB8A1BD06,
    0x6A80EA6F, 0x71A29506, 0xEF78AACF, 0x8D52B5ED, 0x9F0A4966, 0x61B3B68E,
    0x4B17AF96, 0x5B282C2E, 0x75582272, 0x16E54299, 0x7D070B9C, 0xAB130157,
    0x76C619D2, 0x5500E2D5, 0x1F980459, 0x5D9C7F83, 0x6A0DDA1D, 0xF6E8B610,
    0x25D0E0A1, 0x242749E0, 0xFEDA4A06, 0x072D69D6, 0x03C7DA79, 0x51AA3355,
    0x6E9FEFF0, 0x0797CBF1, 0xE936C824, 0xC9C1EAF5, 0xD4607E46, 0x88ED7B0E,
    0x92E160AD, 0x731140AD, 0x32FEFCAF, 0x70863B75, 0x3846F110, 0xC4E23DFF,
    0x79D3F753, 0x064648FA, 0x830452F5, 0xB9ED8445
};

static const uint32_t g_n8192_k4096[8*512] = {
    0x616DB583, 0x006DB999, 0x54780CD6, 0xDFC99087, 0x72D8260D, 0x390B1D46,
    0x2A8F62DE, 0x88092161, 0x94BE0531, 0xEE408AEA, 0xF27F50F3, 0xAD71865A,
    0xC7910EEF, 0x8824A858, 0xCA7B13FC, 0x843DAFB1, 0xBA3E0B01, 0x0860D090,
    0x66A8632E, 0x2B273DAB, 0xDF90C26F, 0xCDD989C2, 0x831874EA, 0x7FBA23D9,
    0x40A29411, 0x1C1B0C1C, 0xF62F56A3, 0x76B94CF6, 0x4FA594B9, 0x87B19226,
    0xE525704D, 0x7F2BC66E, 0x226C671C, 0x22A59AC0, 0x62490596, 0xEB1536C9,
    0xF66AE799, 0xC2489FAD, 0x2C131E29, 0xED64A25C, 0xB0ADC88D, 0x04C5EC8F,
    0xECD7F78B, 0x3825E626, 0x858CFAA0, 0xDE77772C, 0xE8822C7A, 0xA39628A0,
    0x123B1C42, 0x6E2A9336, 0x6D067D26, 0xDE51362E, 0xA0BA916E, 0xBD122952,
    0x1B1B0444, 0x59B32578, 0x5F3F3E24, 0x199B2460, 0x151E4CAA, 0x9FD26A5D,
    0xC46BE0D6, 0xDA907EFA, 0xF38F4136, 0x42F702F5, 0x324AFD5D, 0x62F4CC25,
    0x1FF5C0FD, 0x95DE0FAB, 0x061F0C92, 0xCA5BC97F, 0x976118AD, 0x84E0663A,
    0x3BF1B4F0, 0x7D1CCCC2, 0xDF9E09D5, 0x06B073DE, 0xD87CC065, 0x3C944FC7,
    0xD438223C, 0x0DF3EB67, 0xE62AE13F, 0x8D4000D6, 0x16E81404, 0x5495F6E9,
    0x69C473B0, 0x59386F5D, 0xDBCC25F4, 0x002EB132, 0xD73A9841, 0x4D85346F,
    0x55DEBFF8, 0x75F7CB9D, 0x2466A412, 0xD180E0A1, 0xADA18D28, 0x1376A671,
    0x8EB0FB6B, 0xB7B9AD2A, 0x21320105, 0x11077F6B, 0xD424B6F5, 0xB578C11D,
    0x0076B781, 0x930F755E, 0xBB72C41E, 0xD1751947, 0x6C257C31, 0xC3159BF3,
    0x1FADA275, 0x5F1B8A23, 0xB22D6A42, 0x8AA290E2, 0x54CC73C7, 0x599AB67C,
    0x6807C428, 0x6BECF842, 0x3F3216EF, 0x04E1B6DE, 0x61349DDB, 0x23E3A0EB,
    0x0EF70C5B, 0xE1AD91D3, 0x1B0BB532, 0xC1098DC6, 0x19BF80F3, 0x853EEA35,
    0x7091C05D, 0x95170A7E, 0x5E6381A7, 0x18C0A817, 0xF8101ECD, 0xCDBF825E,
    0x732E4356, 0xCEC42C22, 0x2DBC476B, 0xD704837C, 0x382B7FBF, 0x282B739E,
    0xDC22B5EE, 0xA2909F0E, 0xB3ACB9E4, 0x1FE2AC79, 0x1130A36A, 0x9CBFC1D9,
    0xD4F8DE28, 0xFA77F37E, 0x4A6B5A82, 0xA58CE917, 0xCA74C839, 0x7E9DB8ED,
    0xCB2BF65D, 0xB9195445, 0x7707FE87, 0x6DFF812D, 0x4B99466D, 0xF479A001,
    0x14F27E70, 0x2249DB3E, 0x9311301E, 0x9CE98703, 0x74FEAD00, 0x13FD861D,
    0x67D7CE69, 0xD3635ECC, 0x6266E862, 0xD08B6307, 0x7B45D309, 0x8306EA74,
    0x159DAEA2, 0x263E5870, 0x5EA5ABE5, 0x8B7FD418, 0x62B9EC1D, 0x0F1BD47C,
    0xD6CB4273, 0x9C24F7FE, 0x7ACFF6D6, 0x4C8E8F94, 0xBEABE280, 0xCFDCFCFB,
    0x26AC7330, 0x073C25E0, 0x313DCB75, 0xE6C5261F, 0x15D82AFA, 0x665F73A4,
    0xB4DA4E5D, 0x1648EAB0, 0x51EDEB98, 0x57C13C2F, 0x019FCBBA, 0x4F9DF2E1,
    0x9CEFF114, 0x7D792C14, 0xAA2E211C, 0x3B9B94B2, 0xC9F24F49, 0xB0B1ED6E,
    0x200C88D7, 0x43F5AC1E, 0xE283C3A0, 0xAC79B9F1, 0xF496BDE7, 0x4A2AA591,
    0xACF2F526, 0xFB24413A, 0x58B495F9, 0x1905F596, 0xD8F1469B, 0xCA9CC504,
    0x1C50F1FB, 0x479CF268, 0x0503AD85, 0xBA2C0C6D, 0x01D2D739, 0xF3129315,
    0xE49A9F57, 0x236D9585, 0xCC0B8A9B, 0x4BFE9ADC, 0xD97BED90, 0x06C33976,
    0xACC00468, 0x693D56FA, 0x1EE66371, 0xB0EA6C4E, 0x1E172C2C, 0x5D76806C,
    0xB7376B8C, 0xDEAD96B1, 0x4A1EC2B6, 0x56298B94, 0x25EA2F06, 0x71082D70,
    0xAA23C267, 0xD1F215C5, 0x9239AEB4, 0x0186DF0A, 0xB284625D, 0xC6BAF45E,
    0xFBFBE26B, 0xED98BB3B, 0x697764A6, 0xF82C9403, 0x9CBF14CB, 0x538A7D87,
    0x801ACBD3, 0xA444A858, 0xBB74F0A4, 0x707592EE, 0x6B7DC6D2, 0x1B8F6B4A,
    0x184B567C, 0x8AA4CD82, 0x5EBF7F1E, 0xDCE015A5, 0x25453670, 0x647D23C5,
    0xE445A705, 0x953F3BF4, 0xA5AF02E7, 0xBC46C969, 0xC8141D87, 0x82F171C9,
    0xCFF7EBB2, 0x0945DE5D, 0x363AD36D, 0x3BD5A0BA, 0x081C079C, 0xDD04B6E5,
    0x968187C8, 0xA665344A, 0x23E9B189, 0x7A6FDF42, 0x7B5E910A, 0xA8D71F9C,
    0xC6351474, 0xBC4563C2, 0x0FD38953, 0x295D3BA1, 0x5E7D1010, 0x503B7BA1,
    0xC148251D, 0xB8A88AC6, 0x4E6AF8C1, 0xCC056E4E, 0xEF1C927F, 0xEC40C35D,
    0x57140969, 0x483D9E33, 0x429FAFD1, 0x77D031A4, 0x3B727CF8, 0x32C8DFFE,
    0x8D8960CB, 0x55BE4BE2, 0x7B69CC26, 0xF2FB731B, 0x53250D6F, 0x8EE7DFDA,
    0x98812B9A, 0xAE9C02AE, 0x2FEDEA59, 0x8D6B6E2F, 0x22B6CCA5, 0x0541BD9F,
    0x5D48565E, 0x551B310E, 0x10A0DFCB, 0x8035A5EC, 0x86EB9CD8, 0xC811CDCB,
    0xCCCEC373, 0x2EF93EE8, 0xC9418E25, 0xCA5744E0, 0x7C45F9B1, 0x61E277BC,
    0xECE388B9, 0xB84AAEC4, 0xDA37FE27, 0x7C72CB5C, 0xB1BE92AD, 0x37386740,
    0x3E46B353, 0x5159687A, 0xDC79C39D, 0xEF7005C1, 0xF11F1CBD, 0x5F8877DA,
    0x66AAC156, 0xEF27BB89, 0x3F5F1132, 0x336D52E8, 0xAEB60EAC, 0xF9BEB3CF,
    0xD204D92D, 0xFA496DAF, 0x564272E3, 0xFEC51CE5, 0x3C8F2DF6, 0xACB191E6,
    0x0E14CDEA, 0x28FD5ED0, 0xEBE09672, 0xED11A3F6, 0x466FE3A9, 0x67A4EC83,
    0x90303059, 0xAE00DD83, 0x102A9F33, 0xB2943E4E, 0x6E56928E, 0x7FEE3333,
    0xA36FF3EE, 0x7598744C, 0xF7C298FE, 0xF3EACC7C, 0xCC0F36DC, 0xBA6D87BD,
    0xD4410811, 0x63A65E27, 0xC958AF79, 0xC33A98B8, 0x1814015E, 0x77F82EF5,
    0x120FBDAB, 0x540893B4, 0x7BEB68CC, 0x37F23835, 0xC91F5D36, 0xD6BA6F0A,
    0x5E68FEBB, 0x6E6A2F24, 0x7EB5CF57, 0x684D0770, 0x24946078, 0x8DFDC4A1,
    0x218652BF, 0x881B4BB0, 0x6308EF86, 0x484E7070, 0xAACC72D3, 0x977CF5D0,
    0x6230DEF1, 0xACD4425F, 0x7B155A2A, 0x285CB2A3, 0x2CB9D46D, 0xA09B2816,
    0x7826E77A, 0xEBD85F0C, 0x416595E1, 0x36184841, 0x451F5B3E, 0x1F17D02C,
    0x3DB32C2A, 0xF50091D6, 0x376406D8, 0xCB78A9E3, 0xD3B19911, 0xACC45067,
    0x9EAE25B0, 0xF290FF37, 0x2300F1A4, 0xBC91A43C, 0xB79DB270, 0x133D41DC,
    0x4970F142, 0x0E71C0F8, 0x16EF938C, 0x3C17F0FC, 0xBB6E920E, 0xD853EAF6,
    0xD2DC6792, 0xBF87098A, 0xB94C2E5D, 0xDE78C974, 0xAD6F423C, 0xD5ACA01E,
    0xC9420AAF, 0x3FE83BEC, 0x31D47AAC, 0xD3D62FA2, 0x476C3859, 0x5BD66639,
    0x368181E7, 0x5B44BAA7, 0xADBC2B42, 0xE1D82D7A, 0x59312BB9, 0xA16F7D35,
    0x0B13B44D, 0x828071E6, 0x9DD90DCD, 0x9B713A05, 0xFD8C21AA, 0x5E6E6D8D,
    0xA49A5C3B, 0x34F98A4E, 0x5E822513, 0xF0DA2002, 0x35C65BFC, 0xA1DC2CE4,
    0xAB21D146, 0xB778F680, 0x6680B8AC, 0x75285760, 0xFEF66B86, 0x1AA67C76,
    0x8A76D585, 0xDFADC8EB, 0x6556AD84, 0x1DEA9F44, 0xACB42B60, 0x16142B6B,
    0x69F18334, 0x74FADEB0, 0x400CE4D9, 0xF3BD62AD, 0x96E57F3E, 0x93DD2291,
    0x80F2D4B5, 0xE77D098F, 0xEEBE2DFA, 0x4D4D86EC, 0xB07EEE95, 0x65FB5898,
    0x55E1F53B, 0xA1B9784A, 0x8D195A0E, 0x37215512, 0x70089C53, 0x5216636F,
    0xBEB4D9E5, 0x0A9EAC3D, 0xCB27891A, 0x7005A2AD, 0x87427E6B, 0x8326F6B3,
    0xCA225C7B, 0x2A9EABFF, 0xDDDBC130, 0xB5342917, 0x848B0299, 0x17BA98FF,
    0xD6EF2389, 0x006A6B41, 0x7F678C61, 0x458EF625, 0xC96C0D3D, 0x07945ABB,
    0x9836CF80, 0x823EB624, 0x4D86D114, 0xCC5DC2B1, 0x94F5D55C, 0x398B16A7,
    0x1497C4CF, 0x102C2F10, 0x35C19D5D, 0xFC8A301B, 0x8DE33D41, 0xD909C15A,
    0x3093B09E, 0x7489CE6A, 0xA14B331B, 0x70E76637, 0xFE6DDFFF, 0xA6DC4C51,
    0x0371CB0D, 0x2A6EA3DA, 0xAC5F866D, 0xD75CD4C2, 0xD5959AC3, 0x7DE4E1E8,
    0x70313A5B, 0x2902F234, 0xCD939FE3, 0x9F31FEBF, 0x8B46DAC9, 0x06E3EBA9,
    0xC3A74DE4, 0x6E7A9140, 0xD3716667, 0xBB1EC22A, 0x87D5F8D0, 0x48BDC5BA,
    0x57B60243, 0x27CDDFF3, 0x296BE650, 0x8C48045B, 0x71FA5191, 0x56F8C125,
    0xF4E3B735, 0x6576F32C, 0x63BC5889, 0x08C4E8B3, 0xF9F2D12A, 0x9E8F35B6,
    0xFCF296C1, 0x7FD8E8D0, 0x76406FA1, 0x1D16175F, 0xCC45AE82, 0xD672979E,
    0x8A0A359B, 0x2328C79A, 0xE61F87EB, 0xE04DAC93, 0x43030548, 0x65973200,
    0x0CE62741, 0x7B3F8CFD, 0x4A992E7F, 0x2B680216, 0xAF773385, 0xB9337E17,
    0x43D43FD9, 0x65282CF5, 0xAE71B0CA, 0xFEB4DA3E, 0x0B95F134, 0x1667C519,
    0xFB9F89D7, 0xCEC711E5, 0x7485F04A, 0x965CDC83, 0x2CBEC0BE, 0x1B2A3E23,
    0xB5EAF4C5, 0xDAD8767E, 0x054B2225, 0xA60B88BE, 0x1DB6A35E, 0x0BAEB237,
    0xA206BC72, 0x1B252D52, 0xEA1F8E31, 0x1203DFF0, 0xAE8D65BD, 0x19860557,
    0x01A3C7FE, 0xB2DDEDD2, 0xD57C3BBA, 0x6A2BC56A, 0x9157677D, 0x7B48AD29,
    0x07927176, 0xF6B22E8A, 0x92F6E986, 0x3C9E16D9, 0x11B6209E, 0x06EFE6AC,
    0xBBBA2214, 0xEF5AEAB9, 0xD7664547, 0x6B2C16B8, 0xD14E1AE3, 0xF3A85188,
    0x835922B9, 0x14D3F32F, 0xE05B7987, 0xA2516B3D, 0x3C8983AE, 0x176DFD04,
    0x349A4535, 0x9B422E1E, 0x01CC2266, 0xF2B68A43, 0x23F8931D, 0x7AA37B1C,
    0xBD70DC2F, 0xEE915923, 0x27207AA6, 0x12179515, 0x0A0DC918, 0x704A1A29,
    0x3778FE75, 0xA99FDCE7, 0x7E820D09, 0x05EF7AC7, 0x2A682F24, 0x87A6E0FE,
    0x03F42D94, 0xFDE1C13F, 0x958DF611, 0x12DB4A27, 0xA8A8EF35, 0x087FD089,
    0x729F0864, 0xC2706CCB, 0x2B6CBD91, 0xA9A7B7B3, 0x1E08EA35, 0x70A6E1BE,
    0xD495FC84, 0xFACD829F, 0x3234B1D1, 0xDC574B67, 0x900AA496, 0x43295914,
    0x1795C615, 0xCBAEA980, 0x02440A0D, 0x447EF990, 0x435E452C, 0xC690203B,
    0xDEBCBA3E, 0xEFC7A7CE, 0x71EB54B1, 0x728AEA9E, 0xDE70A7E6, 0xA1A8AE86,
    0x168709A8, 0x99738CCB, 0xC5B7A094, 0xAEBEA8EC, 0x95A414A8, 0xDE5D3DBE,
    0x6745CB0D, 0x330B7843, 0x5AC2BB66, 0x66BB2D43, 0xA19EAD3B, 0x3D9536D0,
    0xBB92DB94, 0x9570981C, 0x22805E7D, 0xEA452FA6, 0x49C84EDC, 0x4324A7FB,
    0xE6A9CAF4, 0xEE484007, 0x20B8F84C, 0xAC3A4248, 0x3B7E5718, 0x46E2A5F7,
    0x7A983EE3, 0x11179CEC, 0x2D99878F, 0xF5AA06AC, 0xA0CBBA63, 0xB36985E0,
    0x970761E7, 0xF837650B, 0xC46C9A2E, 0xB1AEFA95, 0xAC4D8AA5, 0xC970BB55,
    0xFDF34083, 0x56C9EB26, 0x83B6FEE5, 0x93736B66, 0xB49C055B, 0xD6503EEF,
    0x3C7CADD1, 0x5C9B86DC, 0xA626E1AB, 0xF4B971D0, 0x4C0A9A5A, 0xEF8305C3,
    0xD0E4CC02, 0xC32FA91E, 0xD8949EF8, 0xFEADF7DA, 0x39D395B5, 0x2D2779A0,
    0xB305C4FD, 0x10C33A43, 0x4878967D, 0x9321B483, 0x5C035CA5, 0x802C37F6,
    0xDC1E39AC, 0x30337253, 0x114176BB, 0xB2657631, 0x7C72E954, 0x8F179A5A,
    0xA200FC35, 0xB6A0934D, 0x57543A60, 0xF6114B7B, 0x0D78D8DD, 0x8932538E,
    0x545D806A, 0x1D9E4739, 0x0F092501, 0xF4A470CF, 0x7B1F9144, 0xD0A8F1B0,
    0xC3D60793, 0x0A75E5A1, 0x50233DCE, 0xEDB4C10B, 0x217C8EB3, 0x8D4D2A0E,
    0xF1255732, 0x1D504ECA, 0x670B41E4, 0x96441FDE, 0x341F0232, 0x101D4E3F,
    0x4158FF6F, 0x4EAECC07, 0x3AA811DD, 0x450F528B, 0xC6095868, 0xB7BF9539,
    0x26056BD4, 0x09E5FE36, 0xB82831B1, 0x50B80A73, 0x6D6CF7B1, 0x6660ADCD,
    0x5E1F4DB9, 0x6E36E33D, 0xCC2F1506, 0xC7B8B0F2, 0xA4EC362F, 0xB0CF7B8B,
    0x3B08D6CD, 0x1AF74407, 0x29D4C3C0, 0x2627AD87, 0x33A0C94B, 0x2EBAF526,
    0xFDB4463E, 0x6F8FBAF5, 0x65B1C332, 0x0F5704A8, 0x7309E529, 0x842378EC,
    0xB733784F, 0x1CBD85F4, 0xF87FB052, 0x5C7C4D30, 0x7061F74D, 0xE2FB3BDF,
    0xBC77E04E, 0xAB75A64F, 0xFE51203A, 0xB925E807, 0x1D1101A1, 0x6A2C41DB,
    0xDCA94C12, 0x8560BEFD, 0xA4ECA6F2, 0x2B44C6E5, 0x085A23F8, 0x4106E4FD,
    0x870FAA78, 0x9E03FC37, 0x086E67B6, 0x9FC8EB64, 0x21AA57FB, 0xA27866DF,
    0xF712D5FE, 0xDA21FC51, 0x76EE3CB2, 0xC4A8629C, 0x20FC646A, 0x7ADF2A4B,
    0xE73DCEF5, 0x3FC92606, 0x7EB99649, 0x96BCEE40, 0x3C5642CD, 0x2F8084E0,
    0xC14D3627, 0xFAD9F018, 0x0DADF073, 0x31246C00, 0x7F3AF95C, 0xC9B451CC,
    0x3638887E, 0xB493F5EE, 0x3361F07E, 0x00F115BC, 0x04AF404B, 0xE6BA3467,
    0x322B37A8, 0xE6ABF477, 0x10D56C3B, 0xC751892C, 0xFD12F29C, 0xC4319D05,
    0x62005562, 0xD05261D3, 0x9FDF528A, 0x11E65BBE, 0xA0BF07C5, 0x2E9A9ED7,
    0xAC3F0FB9, 0x196A450E, 0x16200950, 0x9F20BEE7, 0x4FCC6316, 0xBC4824D9,
    0x3CBAC25E, 0x470A7468, 0xA629EB52, 0x0E980DE3, 0x1F8C8873, 0xF4ED21B5,
    0x7AAEBF43, 0xA5754359, 0xCD089ABE, 0x54897567, 0x8C212322, 0x3CF3F345,
    0xAE0CECF0, 0xA3726BFB, 0xB130E341, 0x69A874B6, 0xC4CDEFC0, 0xA05D7DA1,
    0xEE475E54, 0x07F15353, 0x99086700, 0x874C1300, 0x0E2EE21D, 0xF3EEFB65,
    0x4BEF6F2B, 0x4137DC6E, 0xF197D514, 0xE904B8F3, 0x1BAD6C84, 0x6D6BD7D7,
    0x480F4818, 0xC3C57B4C, 0x7F53F168, 0xE4802027, 0x3702071E, 0xE48EC534,
    0x22C71C90, 0xAA026298, 0x2B82BB6F, 0xF3100D8A, 0xEB3E8F03, 0x3DA73FA8,
    0x2B3B93E5, 0x0C60E593, 0x6A07D321, 0x8946588D, 0x0EFB39E1, 0xA55C0FB9,
    0xDBA87DA5, 0x0C4697EE, 0x2ED72B00, 0x4301019E, 0x595B92A2, 0xF55F7F1B,
    0x37C2030B, 0x79057F52, 0x59CA1335, 0x9E16B10A, 0x7F8778BB, 0xAF5D45E3,
    0x2C643B52, 0x4022FE77, 0x7A8F557C, 0x14141D63, 0x8E84BC4D, 0xBB1CE586,
    0x6CD0B89C, 0x1CC5C6F7, 0xBF7E25D2, 0xB4FC28A1, 0x6E67CF8B, 0xFAC4F4BD,
    0xA612F300, 0x67700487, 0xB6584B1A, 0xD578659F, 0xC2B74432, 0x28B2B7B4,
    0x43882DAB, 0xBF55739C, 0xB9660F53, 0x0631A2CF, 0xDCBE94D2, 0x1692CAC0,
    0x1DA9EB50, 0x48FFF17B, 0xC4FB5957, 0xE8C9DF1F, 0x29E0573D, 0x85359FB7,
    0x924AABBD, 0xDDCD26F5, 0x740FFA68, 0x24FCFCBD, 0x53BF1DFB, 0x587E0667,
    0x641DD3F8, 0x2962F5E6, 0xEA264612, 0x79B0F694, 0x79645462, 0x983DBBBC,
    0xC544DA90, 0x255121EA, 0xA97C7B71, 0x923F0382, 0xDF60C9E3, 0x4D84CAC2,
    0x89B57889, 0x9EBCF924, 0xF4304B80, 0x581C9887, 0xB1198F07, 0x4143DCC4,
    0x324D7DF3, 0x01466AC9, 0x7903E688, 0xDD2E9186, 0xEDD2D90C, 0x34202AA3,
    0x90815D48, 0x9B715FF6, 0x04788F33, 0x5322DF5C, 0x8856FD85, 0xF753785A,
    0x96F4B256, 0x1990F458, 0xC69D3F99, 0xA8ED1BE9, 0x9C3F5A14, 0xB19B37AC,
    0x729B3F35, 0xABF52006, 0xE814B597, 0x145FA3FD, 0x86A5A203, 0x8BB67CF8,
    0x225BCCF7, 0xA587E0D0, 0x9B47D26B, 0xC4DB017F, 0x6A77B6DE, 0xC5AF5B11,
    0x7E399D8A, 0x336358D4, 0xAABE9C8E, 0x7EAAF644, 0x7638F2DC, 0x66EF65C1,
    0x00D06EE2, 0x02013042, 0xAD845A43, 0xD23E66FB, 0xA72D9D56, 0x457D66C7,
    0xE44D98ED, 0x1E5F1D06, 0x3A5D0104, 0x3930E9C2, 0xEDED8BA9, 0xDEE5F9DF,
    0xF91CD887, 0xF097B9A2, 0xDF0099E2, 0x78C253E0, 0xA549C7A2, 0xD81078C6,
    0x680566EA, 0x7A1E724A, 0x99B5D709, 0x9AED278A, 0x3065BBC6, 0x4BED4411,
    0x54DCD346, 0xD38C9771, 0x648D5565, 0x6B16CF01, 0x2D0C6EC8, 0xF616D3B7,
    0x58089A81, 0x47D731AE, 0x077D5572, 0x04256F93
};

static const uint32_t g_n6144_k4096[16*256] = {
    0x80924F64, 0x8C014F2C, 0x73889C8B, 0x87D0491F, 0xA9FA060D, 0x2902D7AC,
    0xC8B679CF, 0x61EEB5D9, 0x6BB9E90F, 0x5C157AA1, 0xBF03EF75, 0x6245D917,
    0x9063F2CD, 0x999EF1E7, 0xF7925B3F, 0xB7AC7B2D, 0x6CD39516, 0xB201F491,
    0xE2BDCA4E, 0x34542B5A, 0xF3703B3C, 0x8EE753FB, 0xE998E873, 0x23F0B228,
    0xD1F551B2, 0xD7E7822F, 0x201E2406, 0x6584D63C, 0xAA00E8DB, 0x909EB41C,
    0x4157EBA0, 0xF5C76A50, 0xF7C57317, 0x46C6DAC2, 0x60A34518, 0x9009C0B2,
    0x3372F1E9, 0xE0C5A079, 0xD00B0915, 0x8E164B22, 0x33D5F8A2, 0x68041CAB,
    0x66317898, 0xCD0024E3, 0x106EED5C, 0x2171B3F6, 0x276B8EA5, 0x9AA981E0,
    0x010BFF3F, 0x52A49ED9, 0xA6FA7F15, 0x1FCC72B2, 0xAF3BD932, 0x065043F7,
    0x447B4D0F, 0xC4A2B93B, 0xF8D345E6, 0xD2B0008D, 0x1B363BFE, 0x296B55AF,
    0x38E3E16E, 0xC5856A12, 0x2E4931CB, 0x3F2424B1, 0xA099B776, 0xC642FF1D,
    0x84B0DB79, 0x7098E17E, 0x75FE9BB5, 0xCF7FA873, 0x9711A896, 0x60DAF24D,
    0x3CA8DE55, 0x00F68DB4, 0x49BFF742, 0x51B24E46, 0x91EAF386, 0xC81014C9,
    0x1AC70029, 0x8E095F0B, 0x12CEE8B5, 0xF6B93C11, 0xAD628CB6, 0xCB81F76B,
    0xE095C2C9, 0x94A8BDDB, 0x4E2C48C9, 0x42B4D481, 0x1F7E191B, 0x30E8FFD6,
    0xD4A7E9BE, 0xF81BBB0A, 0xE6608F64, 0x7B1AED9C, 0xCA7FEC54, 0x98C03F0F,
    0x1132E816, 0xBDFA0C34, 0x50C39939, 0x11E10EB1, 0x097CD7A1, 0xF32C54C8,
    0xB009654E, 0x56B25A2D, 0x5FD58EEA, 0xED460CEF, 0xC18E2FBA, 0xD2954467,
    0xE32118F0, 0x1D05456D, 0xEA2926A1, 0xE761DF76, 0x4C6C7BF3, 0xA2245C1B,
    0x4630775D, 0xC59EA74A, 0x14EBCD8B, 0x5D72E343, 0xBC6F7FEA, 0x452F2CC2,
    0xC09CE802, 0xB35EBF46, 0xD1F30699, 0x57DF1D15, 0x2377F45A, 0xDF614CC0,
    0xF5DAB8FC, 0xF394CCD0, 0xFEFBA8CE, 0x169FD377, 0x5B2280EF, 0x3BD870FD,
    0xDF7CB95F, 0x2943D0EE, 0xA84529FF, 0x0D1B1C19, 0x0CA5DB06, 0xA87541C8,
    0x1BEF913D, 0x5145F20E, 0xFAD861F6, 0x73B32028, 0xB4713377, 0xC056CE97,
    0xCA3F2133, 0x65EE380F, 0x7E904669, 0x45BDE9F4, 0x4087C8C7, 0x3A7CC5F9,
    0xDE71B768, 0x3D018D86, 0xA6CDFD8D, 0x8117748A, 0x4B41C3F5, 0xA6676549,
    0x5711EDC0, 0x2F9581F3, 0xE7C2E0FD, 0x9004B03B, 0x77D0EF5D, 0xE2ACACA2,
    0xA4371A5B, 0x111B877D, 0x0EDDF83C, 0x3341A5AA, 0x51261FA4, 0xB5A0D7EA,
    0x7C563512, 0xA6B73B3B, 0x43F8D1D1, 0x13D751D6, 0xB2CABBC3, 0x50FF0F8C,
    0x29361DCE, 0x5EB87C8F, 0xF6DFA5C6, 0x72C25179, 0x31371ACB, 0x6462A596,
    0xD41419CD, 0x4F0F84EF, 0xF98DCBBE, 0x610AE03E, 0x05FF840F, 0xB320DD5C,
    0x3FB4FE4A, 0x58585109, 0x14A5161B, 0x2AD3C3E7, 0xFD023585, 0x05190F0F,
    0x5B6D534E, 0xDE13068A, 0x2459CB07, 0x007121B0, 0xF07B08B8, 0x227047C1,
    0xA629DCA5, 0xA4E30D28, 0x5D00E72E, 0x5B6AD57A, 0x9F0F9E06, 0x08702BDE,
    0x8BDBFA37, 0x1C06D96B, 0xFE0E6037, 0x75A875CB, 0x692EB7DA, 0x76BD0D4A,
    0xFE92FCB5, 0xB5184BAA, 0x3EEE3790, 0x0144CA03, 0xB7A22EAD, 0xE2F061FF,
    0xB3CDE246, 0x4AF12129, 0x79A99380, 0x340974A9, 0xF85478E5, 0xA2E8B907,
    0xE74EEFA4, 0xCB7625E5, 0x41AF736E, 0x0AA1416E, 0xA676E43C, 0xF5DFF372,
    0xCFFC30D6, 0xC0A58A33, 0x3268136A, 0x3020033F, 0xF5011138, 0x2FEBA594,
    0xC255896A, 0xB59C0663, 0x8406956F, 0x19B67F80, 0xA3A72760, 0x60D4E7F6,
    0xDCB75287, 0xBE9A2620, 0xA1F59457, 0x0B269097, 0xA51A3254, 0x8BAA6DD9,
    0xB429B8AA, 0xF992C8C0, 0x6210A36B, 0x63DE9C73, 0x2339DC1A, 0xFA94CAB4,
    0x75574A6D, 0x1C4D0C17, 0xF148B8AD, 0x12816B47, 0xE24D7C17, 0xBCC46297,
    0xEDC41AA9, 0xB5C9D936, 0x89843027, 0xC6A78449, 0xF8D151E1, 0xF42BE98F,
    0x4544BD9E, 0x6975DDD4, 0xBC9B3EFA, 0xD50AFC58, 0x2CAE2696, 0x77B130FE,
    0xD2C39D5E, 0xBDEE56B8, 0x6A13BB53, 0xC03B0C8A, 0x4E0D1697, 0x322A1A30,
    0x55054229, 0xA69B6CCB, 0x7E1FB0B8, 0x85B90CD2, 0xBE5C66B2, 0x52E5C51D,
    0x7D9E9E25, 0x922566C1, 0x8F0234F2, 0xA330041A, 0xEC6A4F27, 0x29A2A30B,
    0x1E04A65C, 0xF0BA05C6, 0x2B15FEF9, 0x967ECD97, 0x5EC43C03, 0x5DE4EE64,
    0x22237F56, 0x834AC746, 0x4FD0C1AF, 0x8A61F566, 0x86326F93, 0xEF63E2C1,
    0x14D55726, 0xA5F74BFD, 0x99AE7713, 0xDF2DE6CF, 0xA9CC4B50, 0x995A682C,
    0x6F6F12C8, 0x0929FF20, 0x8C72007D, 0x6A253FD3, 0x6DE363E8, 0xEBF2B614,
    0x95F6F59D, 0xA4CE4BA4, 0xD6D4D371, 0xA2484F16, 0xEFA33CD3, 0x4F71B817,
    0x02F0E99C, 0x031B089D, 0xE16A7B75, 0xAB838252, 0xD1840EF2, 0x935AA1CC,
    0xA5C8470F, 0x98202BAB, 0xA93EEACE, 0x43EE56E1, 0xB2D767F3, 0x5B0F34FC,
    0xE855B53B, 0x6B8DB8DD, 0x08BCF476, 0x84E904FA, 0x47965D72, 0x107897D1,
    0x3D38403A, 0x0D2696A7, 0x67679C6F, 0x9CC37537, 0xA93A125C, 0xE7041EC4,
    0xF39AD745, 0x2597ED13, 0xA0CCD841, 0xB7CA93DB, 0x6F7039B9, 0x29A820F5,
    0x5A95AA37, 0x86C96E04, 0x34DA46A0, 0x84653B1A, 0x08A90783, 0x1A27892D,
    0x0DD5B6C9, 0xFCB5229C, 0x0C036637, 0x94A4E94E, 0x3FB22E40, 0x68ED0EE8,
    0x53BCBD15, 0xAA8DEC34, 0x51CEF535, 0x41B04056, 0xE4DCA039, 0x3836E9B6,
    0xDFCF9B01, 0xE901D933, 0xBD160166, 0x307B70BE, 0x5618C6E0, 0xB4ADEBA4,
    0x6F65C690, 0x80D4C3FA, 0xADF1AA22, 0x911C2C69, 0x42FB1575, 0x074655AB,
    0xD1EFF578, 0x4CBE7FA0, 0xB110981C, 0x8A0BDF01, 0xC650189C, 0x2DC9FC74,
    0xB4035630, 0x11DDE16F, 0x92630CF3, 0x12B3F7F4, 0x95E74B3B, 0x582DFB94,
    0x01F509A3, 0x5BD2528C, 0xA81600F6, 0x437FBD00, 0xFCF0E4AD, 0x41DE3598,
    0x434EE390, 0x3CD1A17C, 0xF618E8E2, 0xA47EBC4C, 0xA1D7816A, 0xE33BA46E,
    0x3A9D5B3C, 0xBDACF93D, 0x538802ED, 0x0FCCEFF1, 0x93DB9D6B, 0x79C7E508,
    0x54B42DDF, 0xAA7DE9B5, 0x299F4C1B, 0x5DA05487, 0x562D2034, 0x9282F706,
    0x1E3159E4, 0xEAB09D03, 0xE15D45F2, 0xD1694FF3, 0xFF1AA1FC, 0x1E58E3FB,
    0xD6875B71, 0xB982AD57, 0xAC96CD3B, 0x7BE8ACC6, 0x90CADDAD, 0x41374E4B,
    0xCA29AAB2, 0x2CAD6198, 0x9158C474, 0xE0725B4C, 0x4C5442D6, 0xA12D94D8,
    0x2827752C, 0xE49CB9C3, 0x85AD35C1, 0x29110989, 0x2EF85A7A, 0x6C043BD8,
    0xE3BA4AC3, 0xD5146FB7, 0x87002794, 0xAC4020B7, 0xD229EAE7, 0x0E01E72F,
    0x1772B0DA, 0x401ABE2C, 0x2D487EF6, 0x0724DC83, 0x413A0F58, 0x974C76AB,
    0x4C17AB24, 0xF37CB105, 0x5FC1827A, 0x1DDB0456, 0xCCAA7F94, 0x77CA64FC,
    0x904E1D93, 0x38D0795C, 0x6844F79E, 0xD8B26A9D, 0x306F6697, 0x5CE704A9,
    0x25E72EC9, 0x5509188B, 0x2B5EC321, 0x2ADF3595, 0x4F1CDA9C, 0xB6CCC28E,
    0x422F23AF, 0x81659F6E, 0x4AFDD03E, 0xFB8AD730, 0x84D1CCA3, 0xB5036F03,
    0x1EEDE0F1, 0x121E6F62, 0xD232DFB7, 0x4A0582EB, 0x3303D1E9, 0x8810A6C9,
    0x221F0EFC, 0xA2C81259, 0xB57F8E69, 0x43D0CD36, 0x088A64DA, 0x7FE2E6E7,
    0xE0F63EAF, 0x873B8A79, 0x57E9B392, 0x45C61730, 0x88B024F3, 0x4ED7B64F,
    0x8784413F, 0xF95E4764, 0x74FECDAE, 0x7BD62E5A, 0x807A8078, 0x32F6AC83,
    0xBC7CA7F7, 0x54BBC7DE, 0x72CCC854, 0x25068F50, 0xED524196, 0x43561832,
    0x1B9CF54C, 0x055FB01B, 0x40740A0D, 0x46985529, 0x2AE8A0C5, 0x8756BDD3,
    0xC6DABE26, 0x8551FD5F, 0xDD8CE660, 0xB7403DC8, 0x672EA620, 0xE65301B0,
    0x865A23FE, 0x568C1736, 0x69EE1D7F, 0x7A1BD748, 0x3CCFAC84, 0xAB188D90,
    0x6D70525D, 0x092C3E2B, 0x46C6675C, 0x1CF4B30A, 0xB346022E, 0x43DA20B8,
    0xA01DC115, 0x9652EA26, 0x0B411971, 0xB0E3D039, 0x3C1E75AB, 0x0EA462E1,
    0xD07D0847, 0xEFA9CFBA, 0x4153E6B4, 0xF4687D43, 0x4414BAA2, 0x00FA38CE,
    0x46B28D3B, 0x4055C633, 0xAAD0ED2F, 0xACD6B415, 0x5234FA7B, 0x72F478A1,
    0x93EC1469, 0x8C611F3C, 0xB70BF72C, 0x15E0DCE9, 0xCC048A52, 0x6AC1F46A,
    0x969C1082, 0x0390DF8D, 0x90AD0138, 0x202A3218, 0x2398B704, 0x05520538,
    0xD08C1F79, 0x9FBC0755, 0x53D8304A, 0x8B5213FF, 0x88DD1620, 0xB1A5125A,
    0xF1CC9A07, 0xF95C61C5, 0xC6C625F6, 0x4FFCDBE6, 0xED1E06EC, 0x959FF323,
    0xFD3E8AF3, 0x553D90BD, 0x529D699B, 0x08B873F1, 0x64F59B1C, 0xD522AC0F,
    0xA5C8A028, 0x49509DEC, 0xECFADD4C, 0x89C03A78, 0xE1564A54, 0x8D89DECD,
    0x90DDBCAC, 0x7964E9F0, 0x545B2078, 0x77BBAFB5, 0xDED6AEAD, 0x3967CA72,
    0x272E128C, 0x97B06868, 0xFD3BB859, 0x96640432, 0x2995ED49, 0xB525D47C,
    0xE868EFD6, 0xFDBB0BB6, 0x975DC82C, 0x8580D00A, 0xBCB9FFC6, 0xF532A0CB,
    0x9F0B1EC3, 0xBC16C2E7, 0xC94F5149, 0xD03677AD, 0x03945218, 0x0B24DA43,
    0x4F5BBAA0, 0xBCEE64ED, 0x910009CE, 0x6C11178F, 0x5BC79475, 0x4EBA7200,
    0x3E9A53CD, 0xA988B33C, 0xE2D0A096, 0x5DAACA23, 0xBF8A7AE5, 0x330F4813,
    0xAE7F8E4F, 0x25666EAB, 0x3F0351BD, 0x34ABBFA8, 0x874D88D5, 0xFC4E9385,
    0x45A0C20F, 0x7DFD3928, 0x72ABDCB1, 0x9E4F6F09, 0x7044266B, 0x9EA6F0B3,
    0x18A5011D, 0x0E51E735, 0xEE58F5FC, 0x44AE8595, 0x64B64F3D, 0x173C58FA,
    0xE938AFB9, 0x34CBB972, 0x45F7B1A1, 0xDDD4C559, 0xC7DF1E82, 0x1B249BE3,
    0x5E6CAB84, 0x2F3DFCD0, 0x141E4281, 0x41C28BDC, 0xF54B0985, 0x329F6E2A,
    0xD8C08307, 0x5232BDEA, 0xDEA797B6, 0xC9E15606, 0xA72B8B48, 0x502B1C04,
    0x4BA89A8D, 0xBC54EB6E, 0x718EF66E, 0x726EA72E, 0x631B9B22, 0xE193F012,
    0xF3FB2D11, 0x2468B0DB, 0x89F0C3C8, 0xA143E9B1, 0x7D6BE8EA, 0x6A522A10,
    0xF46EC5A5, 0x6E3F5725, 0x86884547, 0x536AFFAD, 0x0C82A42D, 0x88AAA64B,
    0x0B740E17, 0xEEF10A80, 0x0DE1916C, 0x291C1535, 0x84511431, 0x3E908D31,
    0x3B58018E, 0xB77DED61, 0x9A5F7429, 0x731308EF, 0xAB68D172, 0x5D8F9501,
    0x234F9035, 0x869415A6, 0x2262095D, 0x77A9613A, 0x9BDCBC26, 0xABDE4672,
    0xBE5F130E, 0x1089BE8B, 0xF5CA0ED3, 0xFCD9F28B, 0x75CC07E9, 0x822AA2EF,
    0x6AC735D6, 0x621C86CE, 0xA203E9E1, 0xFC993207, 0xEDC16439, 0x6C7C8FF2,
    0x27F92979, 0xA313914D, 0x8E1D4E30, 0x8C03F66D, 0x73D76A71, 0x5F859BED,
    0xBC8D709D, 0x4BEFC155, 0x8D74B498, 0x60A90ABA, 0xB67C7504, 0x1BFB3A61,
    0xBBBB73DE, 0x2B3D7BB5, 0xCB254F10, 0x257495E3, 0x185C71C3, 0x559D9CD0,
    0xACB7A163, 0xEB1E0886, 0x24F94690, 0x9B29B2C7, 0x373C5CF4, 0xF6B1F3A7,
    0x5DC49B15, 0x74B3AAB8, 0x327C5514, 0x2CE3D138, 0x2EA917A7, 0xC6730E01,
    0xBA6BA437, 0x67D53E84, 0xFFB7D61D, 0x6EAD24AD, 0xCFAAC260, 0x24A1D642,
    0xC795400B, 0x8646533A, 0x435A4FE8, 0x99704FAF, 0xAE2BF452, 0xBD9AF093,
    0x53759538, 0xB5F4A861, 0x4F1AB484, 0x0CFC1EFD, 0x8CAFCB06, 0x7C991FDF,
    0x2658ABA2, 0x3F8B0B93, 0x6B3A35CD, 0xECD26C58, 0xB9F1318A, 0xF46F1376,
    0x7758FC0F, 0x74B7DD05, 0x0A9B1A1C, 0x7F98B930, 0x4B4C20D0, 0x40F3A8C7,
    0x46453ECE, 0x10C0A1F4, 0xF74BDDB1, 0xA8FCFE1D, 0xE2C19148, 0xA5E88F1C,
    0xA98B4DE6, 0x8DDB2434, 0x893BEF8F, 0x2CF8DB58, 0x4CEE8F0E, 0x39D30CD4,
    0xC87017E7, 0xEE6886F8, 0x23024E83, 0xF777D7DF, 0x0D7E46A8, 0xB5F9B133,
    0x1D0BC2F7, 0x9BF5559C, 0x3241D5BD, 0xC7E7A665, 0x9E1DD503, 0x73C16CC9,
    0x7A5E3909, 0x21B471EF, 0x5B39731C, 0xCC2CBDD0, 0x88760806, 0x80F9D974,
    0x9DF22EE3, 0xAB758F85, 0xFD490012, 0xFCFF20B3, 0x329A5648, 0xD2585903,
    0x6C0586C6, 0x5F46236C, 0xB009BA26, 0x50ABAFC4, 0x5653D61D, 0x2BFA255D,
    0xE767D0B2, 0x5AC7736E, 0x8E5200D2, 0x1EE3E28F, 0xFD96F63D, 0x0A22CD57,
    0x4ED61899, 0xECDEB4BE, 0xB333F994, 0xAC7791FF, 0x89EC600B, 0x857D4DDD,
    0xC2773C7D, 0xCE36709F, 0x70180CFF, 0xAE22AD44, 0xA4A20211, 0x224F8ECF,
    0xB336A54A, 0x681A1F59, 0x5C00C419, 0xC78A79AD, 0xA49562EF, 0xB784ECE4,
    0x4BAF45C1, 0xE75BD84D, 0xE7C1C691, 0x00F8B93A, 0xDAB0C7C6, 0x5F0D0963,
    0x51BF8A0E, 0xE9CEF5F7, 0x756A9A47, 0xB4EE8042, 0x0DEFA16B, 0x0E74CF18,
    0x0FAB86E7, 0x62595261, 0x852E38F9, 0xD797D4F7, 0x96DA1816, 0x9AFAC99E,
    0x8235D4DD, 0x6C2BB887, 0x15D0F65E, 0x9ADB2C67, 0xA887E5D8, 0xEF4E1080,
    0xAC968F4C, 0x0D673CA7, 0xA74759A7, 0xF1B4E383, 0x1B5641CE, 0x5FADE005,
    0xEB947BE5, 0xE20E7DDA, 0xF6372655, 0x825B3516, 0xF2EC5B36, 0xD687895F,
    0x2C0BB35E, 0x3C3EDA32, 0xC19BFF6F, 0x3A2397A8, 0xE25C6460, 0x59359D90,
    0xA1372FCA, 0xEE250A43, 0x8AABBF16, 0x2C4499F2, 0xFECFA27F, 0x8D7582FB,
    0x607B88D0, 0x4F4A6100, 0xA3D2F8A8, 0x8A2E5E80, 0xD9C26C2A, 0x023943BC,
    0x62F3C186, 0x58A0F5C6, 0x4130BFF0, 0xD74BBB85, 0xEBFFFE19, 0x7C94C6EC,
    0x0AED3853, 0x93F69FA9, 0xF7E69DDC, 0x061B85E4, 0xE77D0BE2, 0x013061E9,
    0x4A0DB8AC, 0x2995096F, 0x775369B5, 0x9AA940DA, 0x96B47429, 0xC339536B,
    0x51ECC59C, 0x60BAD762, 0xFA275A6A, 0x8F90885A, 0x922A84AE, 0x2B06B400,
    0x3C0A7BE2, 0x2FB21136, 0x5376C3FB, 0xFC03EB0D, 0xEA264F67, 0x69B57EE2,
    0xE518ED3D, 0xD8553DC8, 0x815E57F2, 0x3DADC1A3, 0xE99030AA, 0x02A35296,
    0x04EE4BD6, 0x6D770F8E, 0x8AB3C940, 0x77F85772, 0x647897A7, 0x6CFE4EC5,
    0x6FCAA7A2, 0x8968065C, 0xC73BDD88, 0xADA4D60C, 0x9430F05C, 0xFEF8ACBB,
    0xA7303846, 0x3A9AD3BD, 0xE5BA4E94, 0xFDA81C6C, 0x51AB3C69, 0x201906E1,
    0x2613EFCF, 0x23567038, 0x3ED865C6, 0x161C8A89, 0x58DC0928, 0x9EA03658,
    0x376277BE, 0x6E4E62AA, 0x3C90B273, 0xB9870A06, 0x9FE0F516, 0x4AA8F837,
    0xB9905EEE, 0x7D3AEB79, 0x4BA2F4CA, 0xA4F1EB01, 0x01C2973B, 0xD37D564B,
    0x7D21243A, 0x206BD8A7, 0xB435428B, 0xA8DD3DB7, 0x045541BC, 0xCE000F5F,
    0xCEA89305, 0x914BEB1B, 0xE84B59A4, 0xA18CC1AE, 0xB5CC9632, 0x6ADC69F3,
    0xB4957198, 0xC60BB6E7, 0xDB38C42E, 0x2947EFC3, 0x9D2BBFA0, 0x7C18C320,
    0xA22C7B9C, 0x6CBFB72E, 0x6909BDC1, 0x31B2E15E, 0xABECA69D, 0xD1395554,
    0xC852ED7E, 0xE6817A61, 0x52B39B42, 0xF6D7D56B, 0x781D1803, 0xB8307C79,
    0x386FFC16, 0xB79E3092, 0x55E7D593, 0x3870D116, 0xDE3828C6, 0x8348493D,
    0x8E288C8A, 0x3FBF741F, 0x0936252D, 0x32CDEC49, 0xACFE91F2, 0xBA885044,
    0xE0A9ADFE, 0xA526F536, 0x41F97B86, 0x668C5972, 0xF9D8560A, 0x97AFA428,
    0x2DBCC425, 0x0B75A871, 0x276434FF, 0xA80959F0, 0x4D3400D8, 0x1937617D,
    0x799C3EDF, 0x3F134590, 0x8B306D83, 0x72A740E9, 0x6707761F, 0xCCA9B861,
    0x402134AE, 0x9488387F, 0xF2DA86FE, 0x2BAA7E67, 0x5DFDED45, 0x499AF1B4,
    0x0AE292B1, 0xDE6B7A7D, 0x4799C3B8, 0x8177704D
};

static const uint32_t g_n5120_k4096[32*128] = {
    0x473BC533, 0xA12C3596, 0xF642673D, 0x0DBF1142, 0x079A3868, 0xE1A6F556,
    0xF0DF3DCA, 0x4493AE54, 0xAE4C50F1, 0x2AEF6EED, 0xEA9BB306, 0x05F4A24C,
    0xB0B2B4B9, 0x035331AB, 0xF53DE475, 0x2E7EDABF, 0xE7E08EF3, 0xE22EE7EF,
    0xE645E9E5, 0x9507A206, 0x52E4A2C0, 0x6270B2D1, 0xA418134B, 0xC0D58678,
    0x0A84E533, 0x03F4092D, 0xB47056AD, 0x3C0847AD, 0x2DEF7381, 0x3B17101E,
    0x79A3A58A, 0x7E91C4E2, 0x667AA815, 0x610234DB, 0xA0FFA951, 0xCABB8BA7,
    0xA3271642, 0xE4BCDD24, 0xF8D89BD7, 0x83317ABB, 0xCC64FA95, 0xF06AE45C,
    0x7E38935D, 0x78BF5F80, 0x510CE9AB, 0xC6156F00, 0x8B317C79, 0xE0122B09,
    0x3CB09E20, 0x016A5F93, 0xE207C144, 0xE889F3B9, 0xAE6185E4, 0x345C5971,
    0xE03AD499, 0xEF850D33, 0xFA8B392C, 0xE78B5712, 0x290CB2F5, 0x18F3E0CC,
    0x429C39F0, 0x915EB60C, 0xA0545B6A, 0xB2967149, 0xFE9FF6C2, 0x6898CB92,
    0x6F9BCD12, 0x9AA52083, 0x3FC159DB, 0x58B64D39, 0xCB278474, 0x34F177E2,
    0xE040D713, 0x65D96A1D, 0x54FD2005, 0x1D3A50E7, 0xE8AC736B, 0x6D2BB546,
    0x8FBF68DD, 0xF5789C2F, 0x4954E415, 0x3CFF0F52, 0xF8F8F5B2, 0x43A03E2B,
    0x99A1DDD2, 0x3204D103, 0xE323158E, 0x0FEE7673, 0x43C2A070, 0x46BA1B43,
    0x07BA6CEC, 0x7D740CFE, 0xCB4E113F, 0x94C6CAA4, 0x652EFD86, 0x7B43D199,
    0x081E779B, 0xF01F34C9, 0x7337A3AB, 0xC8698644, 0x9C9E7941, 0x55E27547,
    0x283C1AB2, 0x706A388D, 0xFB9DFD19, 0x4731EC2A, 0xE99EA6B6, 0x41B309A2,
    0x258D45A1, 0xBBEAFFC7, 0x87E61289, 0xA54A2473, 0xFDF3E96C, 0x7679E979,
    0x911C4BE6, 0x5A333250, 0x178259F8, 0x46AA9557, 0x7C2EC448, 0xEE709423,
    0xA61BE7CC, 0xED034296, 0x5CA234AF, 0x02914916, 0xE045B3C5, 0x85714F27,
    0x2D40C808, 0x5AE5E8F4, 0x7FB352B2, 0x6E544BDC, 0x18D76B32, 0x3C3CE1BB,
    0x8421967E, 0xE08A6F71, 0x9B675F06, 0xF13FF05B, 0x672C29DC, 0x5B80E18E,
    0x2F4C42D0, 0xF6D5D6D4, 0x7DE072F7, 0x3A801586, 0x2A275B2C, 0xEA2FFC1C,
    0x284B87AB, 0xA22362D9, 0x8952442B, 0xBDFBF4A3, 0x2B798BCD, 0x5D8C0B02,
    0xBBE5DE4A, 0x96569F99, 0x409E72F4, 0x138595F8, 0xB3C14074, 0xBD8E33E0,
    0x3B078383, 0x58BBAE63, 0x1C8258D6, 0xB07D2E1C, 0x403149A1, 0xC88E4D48,
    0x93FE719B, 0x2638B7FF, 0x9886F3E9, 0x0FC01869, 0x9F3B3918, 0x3F2219DC,
    0xF5B0D3AA, 0x45122586, 0x7913FF8F, 0xF979BBE0, 0x795DFCBC, 0xC98210C0,
    0x28FD2138, 0x0EBDDABF, 0x0BBE0D91, 0xFA504DC4, 0xDC8848AE, 0xA001577F,
    0x51653E75, 0x5F6CB4F7, 0x5ACE347E, 0xC899304D, 0x1D0EE239, 0xD8A6C2E2,
    0xEA13D4CF, 0xB3394FCA, 0xBF707E3A, 0xCD882B91, 0xFDDD44A7, 0xEA0D1F3D,
    0x14EB386A, 0x5A452498, 0x36829933, 0x53F8D76E, 0xF9850534, 0xD2FB4F19,
    0xF7878974, 0x35C5EB0F, 0xB680840F, 0x8D34A099, 0x5BA0A94E, 0x309A9194,
    0x6C66CAA0, 0x567BFFD6, 0x09B6484B, 0xCD477702, 0xB62A4053, 0xA6916719,
    0x693D5060, 0x8EC1D717, 0x23C38E6F, 0x64963EE8, 0x36ADC6BB, 0xF39F4CD1,
    0xA40947C1, 0x6AEAD43F, 0x621457BD, 0xB766A157, 0xDD6118AC, 0xF503356D,
    0x0B347982, 0x8C296016, 0xAAB1061E, 0xC9FA6BA2, 0x1E81D7E2, 0x2D3A7ED2,
    0xF902B6C3, 0x36258F5B, 0x6B54628A, 0xC96116DE, 0x5968E316, 0x7BB1E221,
    0x714B0F4B, 0x3B9D7E0A, 0xF1237436, 0x1559D0F0, 0xE0C7FCC9, 0x59B1A9D8,
    0xC103B779, 0xB3A769AA, 0x8D955160, 0xE4B9F9B7, 0x231B28E0, 0xB7490C8E,
    0xB883F29A, 0xF6CC4F12, 0xA7D1FA32, 0xF82AAF12, 0x8FBC6AC5, 0x3532AB89,
    0x17AC0639, 0x2CDAC681, 0x817D2F54, 0x75016296, 0x434D8612, 0xF27169A4,
    0x9ED24439, 0x3B87DB5E, 0xB66D806A, 0x5A9ADF46, 0xD83C7DCF, 0xDB4B72CA,
    0xA78E0C64, 0x307885C6, 0xE67C870B, 0xD21EC431, 0x11B79B0B, 0xB0B977D9,
    0x792535C1, 0x6AA7D982, 0xB597FD60, 0x982B8C42, 0xD019390E, 0xFA14B3D5,
    0xC57FF5CF, 0xA1C438AC, 0x576782A5, 0xB48B78AA, 0xAE278E95, 0xDA048F72,
    0x0B7DB5FB, 0x6488287B, 0x893C7E7E, 0x8DCB6E5E, 0xD5DB819D, 0x8901B32C,
    0xB7BA8906, 0xFC3AEADE, 0x22254872, 0xECA99117, 0x74F39404, 0xFA2779F4,
    0xC55D649E, 0x5A6AA628, 0x4A1F8910, 0xEBF76F2F, 0x4E3EF686, 0x266CEBB8,
    0x8363A57C, 0xF1377C68, 0x419BEFE6, 0xC848FEDA, 0x8F141154, 0xBFA88D31,
    0x446EF367, 0xED965F98, 0x1242B3F8, 0x40426E98, 0x010B84A9, 0x57090390,
    0x9CE9E0B6, 0x19E61C4A, 0x481F1DD4, 0x4360BCAC, 0x0938AE51, 0x1B2B47A4,
    0x2F5F59FB, 0xF547D991, 0x85B68FFC, 0x07A32A49, 0x5D9A708F, 0xAECD2C41,
    0x69CFDFFD, 0x21D6B2CF, 0x3F91CF58, 0x20823B83, 0x7D624060, 0x50908C82,
    0xC21CF32B, 0x862166F2, 0x82AF2DF8, 0xE6CADB5D, 0x043FBF86, 0x3ACE6599,
    0x700097EE, 0x5FDDD825, 0x468C5449, 0x85C983CE, 0x69EE0178, 0x288A8E1A,
    0x12009EBF, 0x2E4382DE, 0x2B8D59DE, 0x631991AE, 0x1B67C707, 0x86B43BE2,
    0x860FC335, 0x4C9FE425, 0x3EBF307D, 0x1C643E22, 0x905330D7, 0x6B163401,
    0x20BB399A, 0x08061CBE, 0x9D5765CE, 0x993D7092, 0xA8150DE4, 0x6D6CA810,
    0xE03534D4, 0xDA2B66A0, 0xBF2AEF3B, 0x833E18DF, 0x6C1C0D9E, 0xAB1E26FD,
    0x2481F6BB, 0x6AB674C6, 0xD98BD8D3, 0xFC0E0557, 0x352CF52E, 0xEA654A92,
    0x0DF8D4B0, 0xFD41AD3E, 0xE547119C, 0x2446F840, 0x4C1F458D, 0x1E2F4B70,
    0xD9023F0D, 0xFC06EFE9, 0x24349C5D, 0x9DE2B048, 0xDC74D3E8, 0x88043526,
    0xE864E5EE, 0x002EB3B4, 0xC31A8D3B, 0x3E22D2C6, 0xB3C41365, 0x42237F8E,
    0x3C75AA22, 0x8AB1B2F5, 0x43DF20DF, 0x407EAC80, 0xCAF22FDD, 0xADD586C9,
    0x9414219F, 0xF8074265, 0x2531AC5C, 0xC0E52866, 0x1A68E6BC, 0x5CA7FCA3,
    0x86396D0F, 0x56A2E7A3, 0xD9EC25B8, 0xDEA08EDB, 0x6A9E6CFF, 0xEC7B15C1,
    0xCD481764, 0x80B2E0FE, 0xD349142B, 0xE9888043, 0x9A70BAD8, 0x9B53A446,
    0x1301DF6C, 0x1763EB67, 0x5C9B0F85, 0x2875D4B0, 0x6EFA7FF4, 0x18710592,
    0x6F7C0712, 0x083341F6, 0xA97F398A, 0x275243DC, 0x3D046D9B, 0x0B0B6AB3,
    0xFEB99F72, 0xA70BAF35, 0x50F7B484, 0xC2530BEF, 0x63537B68, 0xEBDCF01C,
    0x672E8B1D, 0xD9564310, 0x36302F85, 0x57CBB4E0, 0xC9CAD206, 0xAB0AD88C,
    0x655E0F52, 0xC70AEEA1, 0xFF7EC97F, 0x9439C9D4, 0xCD71487F, 0x10065DE0,
    0x53233961, 0x7D706AEF, 0xA50A23B9, 0x0B57978C, 0xB7E0C9A5, 0xF3EF66B9,
    0xABA49150, 0x144FCBEF, 0x2C9E63DC, 0x18BE8ADD, 0xA0FD7E7E, 0x8F7FC5FE,
    0x5C55C60E, 0x14C3D7AC, 0x4D00D9F6, 0xC827E1EC, 0x4E40D57E, 0x1740089D,
    0xB1248707, 0xD195C038, 0x4500AD97, 0x6DD321E6, 0x133113D2, 0x44711330,
    0x0260379D, 0x0A20D10A, 0x89901915, 0x7631007D, 0x4DF741A8, 0x08694A99,
    0x56E493B4, 0x668B67FD, 0xF89442CA, 0xBAA2262C, 0x398171D6, 0x2E938504,
    0xCCF8A4E1, 0x3D655D55, 0x91DC40D2, 0xC6607CEF, 0x353E539A, 0x020B0C60,
    0x8F843A85, 0x5BA9B7AE, 0xCD31CCCB, 0x9388FECD, 0xEBEE1CCF, 0x42943E77,
    0x9CA39E64, 0xD8AC9E23, 0xF15A0CB4, 0xC73ACB80, 0x3BF0F0DA, 0x9576923D,
    0x95089979, 0x081ACA77, 0x359B0907, 0x25B62278, 0xF00D0222, 0xCAD4C0FF,
    0x4ABA2905, 0x6D55C5AA, 0xD990AA10, 0xA9A1A9B2, 0x27A09750, 0x826682C1,
    0x57BD7CD2, 0x178FDC96, 0xAFC3076A, 0xF8AFB82B, 0x45FE8F26, 0x28F489F1,
    0x2CFA9566, 0x3A96A30F, 0xB3831F75, 0x6D9E666A, 0x011EE24F, 0x6C5EE283,
    0xC3EE09A1, 0xD5FAF1B9, 0x7B49CB7B, 0x94EDEB20, 0x7221A943, 0x6E1FFDF5,
    0x5D36302E, 0xEBDD74AD, 0x27158F4D, 0x9DF0FA6E, 0x49701595, 0x9B333E79,
    0x885FBE22, 0xB9B72707, 0xE330EEAD, 0x520B31BA, 0xD1A5DC55, 0xEF54193A,
    0xD6C112F8, 0x9677E27A, 0x26F1DC62, 0xE08DF49C, 0x2DF5B029, 0x1E619A18,
    0xD8025020, 0x86037C46, 0x730D20AE, 0x9364A6AD, 0x090B789D, 0x8AA6C6CC,
    0xEA476A58, 0x5503E90B, 0xCAAD943D, 0xD30E1BCC, 0x1D5C236E, 0xD01E9E5C,
    0x8E94E96F, 0xA7252ABF, 0x3EB2DB84, 0xFB4837EA, 0x5153CA82, 0x5D11F86B,
    0x574E63C9, 0x2DD0E75A, 0xD8DDFF2B, 0x37CC97C9, 0x5E83299E, 0x60C44293,
    0xBF0824C6, 0x2EB7980C, 0x5678B852, 0x002834EB, 0x2D630EAC, 0x536FFB78,
    0x9A41F048, 0xC1C68187, 0x734BFB91, 0x6EC3BFAF, 0x4B23BDA1, 0x162B30CB,
    0x7AEA9F03, 0xBEBCF597, 0xC65460BF, 0xAF9C8913, 0x608F9888, 0xE738F4A1,
    0x017AEE47, 0x0FCA60F9, 0x711E9BE5, 0xEB98E7C9, 0x4EE8869A, 0x59EDF8BD,
    0xD52C5B53, 0x88B35249, 0x8EB0D25B, 0x439273CA, 0x6545E82E, 0x69D8677C,
    0x5B23991A, 0x53041EA4, 0xB276405C, 0x156A9DE5, 0xA90889BC, 0x74530A5F,
    0x87CCF024, 0xE591E18F, 0x22735E1E, 0x720A8B3C, 0x29A80F36, 0x96D6F157,
    0xF68ED2F2, 0x389D5D2C, 0xDC59D706, 0x495D815F, 0xD0EE25B7, 0x3218D571,
    0x7572387B, 0xFA03A7C2, 0xA0717B27, 0x763FE223, 0xBDA3EB0D, 0xAFBEF276,
    0x9DBB8235, 0xD11298BE, 0xE28B3977, 0x2ED91A35, 0x92DE6FED, 0x2F6766E0,
    0x1DBA1881, 0x53DEA205, 0x48930E9A, 0x21873E62, 0x863CA15D, 0x6DB058D9,
    0x61A29088, 0xFE3983D0, 0xE1699EF0, 0xAAFA5FD1, 0xA7300569, 0x00988893,
    0x82252873, 0xE627D6FB, 0x7862DE8A, 0x3D0F1A93, 0x87963F38, 0xA82E4703,
    0x78BAB925, 0x2EE72FB0, 0xC798C7C6, 0x84B6E789, 0xB7480D97, 0x12BFA72D,
    0x122F2436, 0x74AD887F, 0xEC1851EB, 0x80A37133, 0xB68F0F70, 0x9DB32E05,
    0xA809CB36, 0x38414FD6, 0xE156821B, 0xDAC256E0, 0xB75342B6, 0xCFF7ED42,
    0x8521AB48, 0xA4C55D66, 0xC9AB047D, 0x79A48428, 0x9C820E8F, 0xADD87251,
    0xA69C0252, 0x5644F41D, 0x03197EF2, 0x6112D606, 0x3DF71AD0, 0x410035AE,
    0x1AE7B0AB, 0x310B6967, 0xC4F82E31, 0xB4D9B491, 0xEF8E4992, 0xFDBA61B0,
    0xB6B367CD, 0xE8DE0CAE, 0x22875F64, 0x1288E733, 0x5C142A9C, 0x7C2E259B,
    0xD38D6611, 0x7E9E861C, 0xD27BF85E, 0x8EEE1920, 0xB57D0C62, 0xB512E2D6,
    0x68B45003, 0x40B7B92E, 0xDD05A44D, 0x36AC1651, 0x4E77C4AB, 0xE92FE174,
    0xB5D9F790, 0x70685288, 0xA22B2A6C, 0x9A75D7A6, 0xEEA5A0DF, 0x8A4950E2,
    0x24C48301, 0x23FAE1EB, 0x6EB0AC9C, 0x2D8C508E, 0x1BB99D67, 0x85EBCCDD,
    0x9CD6A50C, 0xF53CCA00, 0x0624E36F, 0xD0817F2E, 0x19834009, 0x8E60DFBF,
    0xA4EB92DD, 0x48085594, 0xC6F755C5, 0x63F35020, 0x04BDFF9A, 0x2309C6E6,
    0x73CE08D9, 0x4A45BBC4, 0x8B8EC439, 0x06C28869, 0xAD4E41FB, 0x147A7696,
    0x8AB66E9B, 0x68FA00BE, 0xF90D3E07, 0x8D0C6FFC, 0x89A79E9C, 0xF0BE90A3,
    0xD86305B6, 0x491A49B9, 0x222A27A6, 0x8236765A, 0xB32D41B1, 0xE0616C83,
    0x99931668, 0xE57EB637, 0x8C8F4ED1, 0xC27BEDD3, 0x35166846, 0xD0C673B9,
    0xA8D2184C, 0x1901433A, 0x4D768A5E, 0x0109B5CB, 0xC1988693, 0x34D81C43,
    0x2C6A48CC, 0x47FD21F9, 0x608107FF, 0x80FE37AA, 0x4DD3A739, 0x5630BE4B,
    0x64F776C5, 0xFC6B2C31, 0x4DC16B1E, 0x2B2A7F6E, 0x0E9FDAE3, 0xB60F8FAA,
    0xCFA794F4, 0x9FA5A0D8, 0x8BB31D8F, 0xCA7EA8BB, 0xA7AE7EE8, 0xA68580E3,
    0xE922F9E1, 0x3359B284, 0x91F72AE8, 0xF2D6BF78, 0x30A1F83B, 0x3CDBD463,
    0xCE95C0EC, 0x1F609370, 0xD7E791C8, 0x70229C1E, 0x71EF3FDF, 0x60E28784,
    0x78934DB2, 0x85DEC9DC, 0x0E95C103, 0x008B6BCD, 0xD2DAF85C, 0xAE732210,
    0x8326EE83, 0xC1FBA56F, 0xDD15B2DD, 0xB31FE7F2, 0x3BA0BB43, 0xF83C67BD,
    0xA1F6AEE4, 0x6AEF4E62, 0x56508378, 0x0CA89ACA, 0xA70CCFB4, 0xA888AE35,
    0x1210FAD0, 0xEC9602CC, 0x8C96B0A8, 0x6D3996A3, 0xC0B07FDD, 0xA73454C2,
    0x5295F72B, 0xD5004E80, 0xACCF973F, 0xC30261C9, 0x90525AA0, 0xCBA006BD,
    0x9F079F09, 0xA405F7F8, 0x7AD98429, 0x096F2A7E, 0xEB8C9B13, 0xB84C06E4,
    0x2843A476, 0x89A9C528, 0xDAAA1A17, 0x5F598DCF, 0xDBAD426C, 0xA43AD479,
    0x1BA78326, 0xE75F38EB, 0x6ED09A45, 0x303A6425, 0x48F42033, 0xB7B9A051,
    0x49DC839C, 0x90291E98, 0x9B2CEBE5, 0x0A7C2C26, 0x4FC6E7D6, 0x74063589,
    0xF5B6DEAE, 0xBF72106B, 0xA9E66765, 0x64C17134, 0x6D595455, 0x8D235191,
    0x50AAF88D, 0x7008E634, 0x1FA962FB, 0xAB864A5F, 0x867C9D6C, 0xF4E087AA,
    0x5D7AA674, 0xBA4B1D8C, 0xD7AE9186, 0xF1D3B23B, 0x047F1127, 0x91EE97B6,
    0x3FB7B58F, 0xF3B94E95, 0x93BE39A6, 0x365C66B8, 0x77AD3169, 0x65A72F5B,
    0x1B58F88E, 0x49C00DC6, 0xB35855BF, 0xF228A088, 0x5C8ED47B, 0x61EEC66B,
    0x5004FB6E, 0x65CBECF3, 0x77789998, 0xFE80925E, 0x0237F570, 0xE04C5F5B,
    0xED677661, 0xEB7FC382, 0x5AB5D5D9, 0x68C0808C, 0x2BDB828B, 0x19593F41,
    0x671B8D0D, 0x41DF136C, 0xCB47553C, 0x9B3F0EA0, 0x16CC1554, 0xC35E6A7D,
    0x97587FEA, 0x91D2098E, 0x126EA73C, 0xC78658A6, 0xADE19711, 0x208186CA,
    0x95C7417A, 0x15690C45, 0xBE9C169D, 0x889339D9, 0x654C976A, 0x85CFD9F7,
    0x47C4148E, 0x3B4712DA, 0xA3BAD1AD, 0x71873D3A, 0x1CD630C3, 0x42C5EBB9,
    0x183ADE9B, 0xEF294E8E, 0x7014C077, 0xA5F96F75, 0xBE566C86, 0x6964D01C,
    0xE72AC43A, 0x35AD2166, 0x72EBB325, 0x9B77F9BB, 0x18DA8B09, 0x194FA1F0,
    0xE876A080, 0xC9D6A39F, 0x809B168A, 0x3D88E8E9, 0x3D995CE5, 0x232C2DC2,
    0xC7CFA44A, 0x363F628A, 0x668D46C3, 0x98CAF96F, 0xD57DBB24, 0xAE27ACA1,
    0x716F8EA1, 0xB8AA1086, 0x7B7796F4, 0xA86F1FD5, 0x4C7576AD, 0x01C68953,
    0xE75BE799, 0x02448236, 0x8F069658, 0xF7AAAFB0, 0x975F3AF7, 0x95E78D25,
    0x5871C71B, 0x4F4B77F6, 0x65CD9C35, 0x9BB2A82D, 0x5353E007, 0x166BDD41,
    0x2C544731, 0x4DB027B1, 0x0B130071, 0xAD0398D1, 0xDE19BC7A, 0x6BBCF6A0,
    0xFF021AAB, 0xF12920A5, 0x58BAED48, 0x4AF89E29, 0xD4DBC170, 0xCEF1D369,
    0x4C330B2D, 0x11E15B5C, 0xB3815E09, 0x605338A6, 0x75E3D1A3, 0x541E0E28,
    0x4F6556D6, 0x8D3C8A9E, 0xE5BB3B29, 0x7DB62CD2, 0x907F0999, 0x6967A0F4,
    0xFF33AEEE, 0x2C8A4A52, 0xFCCF5C39, 0xD355C39C, 0x5FE5F09A, 0xBA6BCCE0,
    0x2A73401E, 0x5F87EAC2, 0xD75702F4, 0xF57670DF, 0xA70B1C00, 0x2F523EEA,
    0x6CE1CE2E, 0x05D420CB, 0x867EC016, 0x6B8E53A9, 0x9DF9801A, 0x1C33058D,
    0xD116A0AE, 0x7278BBB9, 0x4CF0B0C7, 0x92DD8FDB, 0x3ECEAE6F, 0x2B7F663D,
    0x106A1C29, 0x6E47C14C, 0x1498B045, 0xD57DEFB5, 0x968F6D8C, 0x790263C3,
    0x53CF307E, 0xF90C1F21, 0x66E6B632, 0xF6614E58, 0x267EF096, 0xC37718A3,
    0x3D46E5D1, 0x0E993EB6, 0xDF81518F, 0x885EDA1B, 0x6FF518FD, 0x48BB8E9D,
    0xDBED4AC0, 0xF4F5EB89, 0xBCC64D21, 0xA65DB379, 0xABE2E4DC, 0x21F109FF,
    0x2EC0CE7B, 0x5D40973D, 0x13ECF713, 0xB01C6F10
};

/* Parity check matrices corresponding to the above codes.
 * This repesentation mirrors the definition in CCSDS 131.0-B-1,
 * and can be expanded at runtime to create the actual matrix in memory.
 * Each macro represents a single MxM sub-matrix, where M is a function
 * of the information block length and the rate.
 * The HP macro is now used for PI_K which goes via a lookup table.
 * The HZ macro is an MxM zero block and the HI macro an MxM identity, as
 * previously.
 * Each matrix is defined in three parts which are to be added together.
 * Additionally the matrices for the higher rate codes are assumed to be
 * prepended to the previous rate's matrix (forming a fatter matrix).
 */
static const uint8_t h_r12[3][3][5] = {
    {
        {HZ   , HZ   , HI   , HZ   , HI   },
        {HI   , HI   , HZ   , HI   , HP| 2},
        {HI   , HP| 5, HZ   , HP| 7, HI   },
    }, {
        {0    , 0    , 0    , 0    , HP| 1},
        {0    , 0    , 0    , 0    , HP| 3},
        {0    , HP| 6, HP| 8, 0    , 0    },
    }, {
        {0    , 0    , 0    , 0    , 0    },
        {0    , 0    , 0    , 0    , HP| 4},
        {0    , 0    , 0    , 0    , 0    },
    }
};

static const uint8_t h_r23[3][3][2] = {
    {
        {HZ   , HZ   },
        {HP| 9, HI   },
        {HI   , HP|12},
    }, {
        {0    , 0    },
        {HP|10, 0    },
        {0    , HP|13},
    }, {
        {0    , 0    },
        {HP|11, 0    },
        {0    , HP|14},
    }
};

static const uint8_t h_r45[3][3][4] = {
    {
        {HZ   , HZ   , HZ   , HZ   },
        {HP|21, HI   , HP|15, HI   },
        {HI   , HP|24, HI   , HP|18},
    }, {
        {0    , 0    , 0    , 0    },
        {HP|22, 0    , HP|16, 0    },
        {0    , HP|25, 0    , HP|19},
    }, {
        {0    , 0    , 0    , 0    },
        {HP|23, 0    , HP|17, 0    },
        {0    , HP|26, 0    , HP|20},
    }
};

/* Theta constants. Looked up against (K-1). */
static const uint8_t theta_k[26] = {3, 0, 1, 2, 2, 3, 0, 1, 0, 1, 2, 0, 2,
                                    3, 0, 1, 2, 0, 1, 2, 0, 1, 2, 1, 2, 3};

/* Phi constants. Looked up against j, log2(m)-7, (K-1). */
static const uint16_t phi_j_m_k[4][7][26] = {
    {
        {1, 22, 0, 26, 0, 10, 5, 18, 3, 22, 3, 8, 25, 25, 2, 27, 7, 7, 15, 10,
            4, 19, 7, 9, 26, 17},
        {59, 18, 52, 23, 11, 7, 22, 25, 27, 30, 43, 14, 46, 62, 44, 12, 38, 47,
            1, 52, 61, 10, 55, 7, 12, 2},
        {16, 103, 105, 0, 50, 29, 115, 30, 92, 78, 70, 66, 39, 84, 79, 70, 29,
            32, 45, 113, 86, 1, 42, 118, 33, 126},
        {160, 241, 185, 251, 209, 103, 90, 184, 248, 12, 111, 66, 173, 42, 157,
            174, 104, 144, 43, 181, 250, 202, 68, 177, 170, 89},
        {108, 126, 238, 481, 96, 28, 59, 225, 323, 28, 386, 305, 34, 510, 147,
            199, 347, 391, 165, 414, 97, 158, 86, 168, 506, 489},
        {226, 618, 404, 32, 912, 950, 534, 63, 971, 304, 409, 708, 719, 176,
            743, 759, 674, 958, 984, 11, 413, 925, 687, 752, 867, 323},
        {1148, 2032, 249, 1807, 485, 1044, 717, 873, 364, 1926, 1241, 1769,
            532, 768, 1138, 965, 141, 1527, 505, 1312, 1840, 709, 1427, 989,
            1925, 270},
    }, {
        {0, 27, 30, 28, 7, 1, 8, 20, 26, 24, 4, 12, 23, 15, 15, 22, 31, 3, 29,
            21, 2, 5, 11, 26, 9, 17},
        {0, 32, 21, 36, 30, 29, 44, 29, 39, 14, 22, 15, 48, 55, 39, 11, 1, 50,
            40, 62, 27, 38, 40, 15, 11, 18},
        {0, 53, 74, 45, 47, 0, 59, 102, 25, 3, 88, 65, 62, 68, 91, 70, 115, 31,
            121, 45, 56, 54, 108, 14, 30, 116},
        {0, 182, 249, 65, 70, 141, 237, 77, 55, 12, 227, 42, 52, 243, 179, 250,
            247, 164, 17, 31, 149, 105, 183, 153, 177, 19},
        {0, 375, 436, 350, 260, 84, 318, 382, 169, 213, 67, 313, 242, 188, 1,
            306, 397, 80, 33, 7, 447, 336, 424, 134, 152, 492},
        {0, 767, 227, 247, 284, 370, 482, 273, 886, 634, 762, 184, 696, 413,
            854, 544, 864, 82, 1009, 437, 36, 562, 816, 452, 290, 778},
        {0, 1822, 203, 882, 1989, 957, 1705, 1083, 1072, 354, 1942, 446, 1456,
            1940, 1660, 1661, 587, 708, 1466, 433, 1345, 867, 1551, 2041, 1383,
            1790},
    }, {
        {0, 12, 30, 18, 10, 16, 13, 9, 7, 15, 16, 18, 4, 23, 5, 3, 29, 11, 4,
            8, 2, 11, 11, 3, 15, 13},
        {0, 46, 45, 27, 48, 37, 41, 13, 9, 49, 36, 10, 11, 18, 54, 40, 27, 35,
            25, 46, 24, 33, 18, 37, 35, 21},
        {0, 8, 119, 89, 31, 122, 1, 69, 92, 47, 11, 31, 19, 66, 49, 81, 96, 38,
            83, 42, 58, 24, 25, 92, 38, 120},
        {0, 35, 167, 214, 84, 206, 122, 67, 147, 54, 23, 93, 20, 197, 46, 162,
            101, 76, 78, 253, 124, 143, 63, 41, 214, 70},
        {0, 219, 16, 263, 415, 403, 184, 279, 198, 307, 432, 240, 454, 294,
            479, 289, 373, 104, 141, 270, 439, 333, 399, 14, 277, 412},
        {0, 254, 790, 642, 248, 899, 328, 518, 477, 404, 698, 160, 497, 100,
            518, 92, 464, 592, 198, 856, 235, 134, 542, 545, 777, 483},
        {0, 318, 494, 1467, 757, 1085, 1630, 64, 689, 1300, 148, 777, 1431,
            659, 352, 1177, 836, 1572, 348, 1040, 779, 476, 191, 1393, 1752,
            1627},
    }, {
        {0, 13, 19, 14, 15, 20, 17, 4, 4, 11, 17, 20, 8, 22, 19, 15, 5, 21, 17,
            9, 20, 18, 31, 13, 2, 18},
        {0, 44, 51, 12, 15, 12, 4, 7, 2, 30, 53, 23, 29, 37, 42, 48, 4, 10, 18,
            56, 9, 11, 23, 8, 7, 24},
        {0, 35, 97, 112, 64, 93, 99, 94, 103, 91, 3, 6, 39, 113, 92, 119, 74,
            73, 116, 31, 127, 98, 23, 38, 18, 62},
        {0, 162, 7, 31, 164, 11, 237, 125, 133, 99, 105, 17, 97, 91, 211, 128,
            82, 115, 248, 62, 26, 140, 121, 12, 41, 249},
        {0, 312, 503, 388, 48, 7, 185, 328, 254, 202, 285, 11, 168, 127, 8,
            437, 475, 85, 419, 459, 468, 209, 311, 211, 510, 320},
        {0, 285, 554, 809, 185, 49, 101, 82, 898, 627, 154, 65, 81, 823, 50,
            413, 462, 175, 715, 537, 722, 37, 488, 179, 430, 264},
        {0, 1189, 458, 460, 1039, 1000, 1265, 1223, 874, 1292, 1491, 631, 464,
            461, 844, 392, 922, 256, 1986, 19, 266, 471, 1166, 1300, 1033,
            1606},
    },
};


void ldpc_codes_init_paritycheck(enum ldpc_code code, uint32_t* h)
{
    switch(code) {
        case LDPC_CODE_N128_K64:
        case LDPC_CODE_N256_K128:
        case LDPC_CODE_N512_K256:
            return init_parity_tc(code, h);

        case LDPC_CODE_N1280_K1024:
        case LDPC_CODE_N1536_K1024:
        case LDPC_CODE_N2048_K1024:
        case LDPC_CODE_N5120_K4096:
        case LDPC_CODE_N6144_K4096:
        case LDPC_CODE_N8192_K4096:
            return init_parity_tm(code, h);
    }
}

static void init_parity_tc(enum ldpc_code code, uint32_t* h)
{
    int u, v, i, j, n, k, m;
    uint8_t const (* proto)[8];
    get_code_params(code, &n, &k, &m);

    switch(code) {
        case LDPC_CODE_N128_K64:
            proto = h_n128_k64;
            break;

        case LDPC_CODE_N256_K128:
            proto = h_n256_k128;
            break;

        case LDPC_CODE_N512_K256:
            proto = h_n512_k256;
            break;

        default:
            return;
    }

    /* Initialise h to all-zeros so we can just OR bits on later */
    memset(h, 0x00, ((n-k)*n)/8);

    /* For each row of the prototype */
    for(u=0; u<4; u++) {
        /* For each prototype sub-matrix entry in this row */
        for(v=0; v<8; v++) {
            uint8_t subm = proto[u][v];

            /* If we're setting either an identity matrix, or a rotated
             * identity matrix, or the sum of both... */
            if((subm & HP) || (subm & HI)) {
                uint8_t rot = subm & 0x3F;

                /* For each row in the MxM sub-matrix */
                for(i=0; i<m; i++) {
                    /* For each bit in the sub-matrix row */
                    for(j=0; j<m; j++) {
                        /* Compute the uint32_t containing this bit, and the
                         * bit offset */
                        int idx =  (((u * m) + i) * (n/32)) +
                                   ((v * m)/32) +
                                   (j / 32);
                        int shift = 31 - (j % 32);

                        /* Correct for when m<32 and we pack multiple blocks
                         * into each uint32 */
                        if(m<32) {
                            shift -= m * (v % (32/m));
                        }

                        /* Work out the rotated bit and set it if matching */
                        h[idx] |= (j == (i + rot) % m) << shift;

                        /* If HI and HP were both set, do the same with a rot
                         * of 0 (to add on the identity matrix).
                         */
                        if((subm & HP) && (subm & HI)) {
                            h[idx] ^= (j == i % m) << shift;
                        }
                    }
                }
            }
        }
    }
}

static void init_parity_tm(enum ldpc_code code, uint32_t* h)
{
    switch(code) {
        case LDPC_CODE_N2048_K1024:
        case LDPC_CODE_N8192_K4096:
            return init_parity_tm_h12(code, h);

        case LDPC_CODE_N1536_K1024:
        case LDPC_CODE_N6144_K4096:
            return init_parity_tm_h23(code, h);

        case LDPC_CODE_N1280_K1024:
        case LDPC_CODE_N5120_K4096:
            return init_parity_tm_h45(code, h);

        default:
            return;
    }
}

static void init_parity_tm_h12(enum ldpc_code code, uint32_t* h)
{
}

static void init_parity_tm_h23(enum ldpc_code code, uint32_t* h)
{
}

static void init_parity_tm_h45(enum ldpc_code code, uint32_t* h)
{
}

static void get_code_params(enum ldpc_code code, int* n, int* k, int* m)
{
    switch(code) {
        case LDPC_CODE_N128_K64:
            *n = 128;
            *k = 64;
            *m = *n/8;
            break;

        case LDPC_CODE_N256_K128:
            *n = 256;
            *k = 128;
            *m = *n/8;
            break;

        case LDPC_CODE_N512_K256:
            *n = 512;
            *k = 256;
            *m = *n/8;
            break;

        case LDPC_CODE_N1280_K1024:
            *n = 1280;
            *k = 1024;
            *m = 32;
            break;

        case LDPC_CODE_N1536_K1024:
            *n = 1536;
            *k = 1024;
            *m = 64;
            break;

        case LDPC_CODE_N2048_K1024:
            *n = 2048;
            *k = 1024;
            *m = 128;
            break;

        case LDPC_CODE_N5120_K4096:
            *n = 5120;
            *k = 4096;
            *m = 128;
            break;

        case LDPC_CODE_N6144_K4096:
            *n = 6144;
            *k = 4096;
            *m = 256;
            break;

        case LDPC_CODE_N8192_K4096:
            *n = 8192;
            *k = 4096;
            *m = 512;
            break;

        default:
            return;
    }
}

uint32_t const * ldpc_codes_get_g(enum ldpc_code code, int* n, int* k, int* m)
{
    get_code_params(code, n, k, m);
    switch(code) {
        case LDPC_CODE_N128_K64:
            return g_n128_k64;

        case LDPC_CODE_N256_K128:
            return g_n256_k128;

        case LDPC_CODE_N512_K256:
            return g_n512_k256;

        case LDPC_CODE_N1280_K1024:
            return g_n1280_k1024;

        case LDPC_CODE_N1536_K1024:
            return g_n1536_k1024;

        case LDPC_CODE_N2048_K1024:
            return g_n2048_k1024;

        case LDPC_CODE_N5120_K4096:
            return g_n5120_k4096;

        case LDPC_CODE_N6144_K4096:
            return g_n6144_k4096;

        case LDPC_CODE_N8192_K4096:
            return g_n8192_k4096;

        default:
            return NULL;
    }
}
